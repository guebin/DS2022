<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>(9주차) 5월2일 – draft | 데이터과학 (전북대학교 2022년 1학기)</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="(9주차) 5월2일 – draft" />
<meta name="author" content="최규빈" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://guebin.github.io/DS2022/2022/05/02/(9%EC%A3%BC%EC%B0%A8)-5%EC%9B%942%EC%9D%BC_draft.html" />
<meta property="og:url" content="https://guebin.github.io/DS2022/2022/05/02/(9%EC%A3%BC%EC%B0%A8)-5%EC%9B%942%EC%9D%BC_draft.html" />
<meta property="og:site_name" content="데이터과학 (전북대학교 2022년 1학기)" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-02T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="(9주차) 5월2일 – draft" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"최규빈"},"dateModified":"2022-05-02T00:00:00-05:00","datePublished":"2022-05-02T00:00:00-05:00","headline":"(9주차) 5월2일 – draft","mainEntityOfPage":{"@type":"WebPage","@id":"https://guebin.github.io/DS2022/2022/05/02/(9%EC%A3%BC%EC%B0%A8)-5%EC%9B%942%EC%9D%BC_draft.html"},"url":"https://guebin.github.io/DS2022/2022/05/02/(9%EC%A3%BC%EC%B0%A8)-5%EC%9B%942%EC%9D%BC_draft.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/DS2022/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://guebin.github.io/DS2022/feed.xml" title="데이터과학 (전북대학교 2022년 1학기)" /><link rel="shortcut icon" type="image/x-icon" href="/DS2022/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/DS2022/">데이터과학 (전북대학교 2022년 1학기)</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/DS2022/about/">About Me</a><a class="page-link" href="/DS2022/search/">Search</a><a class="page-link" href="/DS2022/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">(9주차) 5월2일 -- draft</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-05-02T00:00:00-05:00" itemprop="datePublished">
        May 2, 2022
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">최규빈</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      73 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/guebin/DS2022/tree/master/_notebooks/2022-05-02-(9주차) 5월2일_draft.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/DS2022/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/guebin/DS2022/master?filepath=_notebooks%2F2022-05-02-%289%EC%A3%BC%EC%B0%A8%29+5%EC%9B%942%EC%9D%BC_draft.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/DS2022/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/guebin/DS2022/blob/master/_notebooks/2022-05-02-(9주차) 5월2일_draft.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/DS2022/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fguebin%2FDS2022%2Fblob%2Fmaster%2F_notebooks%2F2022-05-02-%289%EC%A3%BC%EC%B0%A8%29+5%EC%9B%942%EC%9D%BC_draft.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/DS2022/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#import">import </a></li>
<li class="toc-entry toc-h2"><a href="#경사하강법과-확률적경사하강법">경사하강법과 확률적경사하강법 </a>
<ul>
<li class="toc-entry toc-h3"><a href="#ver1:-모든-샘플을-사용하여-slope계산">ver1: 모든 샘플을 사용하여 slope계산 </a></li>
<li class="toc-entry toc-h3"><a href="#ver2:-하나의-샘플만-사용하여-slope계산">ver2: 하나의 샘플만 사용하여 slope계산 </a></li>
<li class="toc-entry toc-h3"><a href="#ver3:-$m(\leq-n)$개의-샘플만-사용하여-slope계산">ver3: $m(\leq n)$개의 샘플만 사용하여 slope계산 </a></li>
<li class="toc-entry toc-h3"><a href="#용어의-정리">용어의 정리 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#옛날-(좀-더-엄밀)">옛날 (좀 더 엄밀) </a></li>
<li class="toc-entry toc-h4"><a href="#요즘">요즘 </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#ver1,2,3-이외에-좀-더-지저분한-것들이-있다.">ver1,2,3 이외에 좀 더 지저분한 것들이 있다. </a></li>
<li class="toc-entry toc-h3"><a href="#Discussion">Discussion </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#fashion_mnist-모듈">fashion_mnist 모듈 </a>
<ul>
<li class="toc-entry toc-h3"><a href="#tf.keras.datasets.fashion_mnist.load_data()">tf.keras.datasets.fashion_mnist.load_data() </a></li>
<li class="toc-entry toc-h3"><a href="#데이터생성-및-탐색">데이터생성 및 탐색 </a></li>
<li class="toc-entry toc-h3"><a href="#데이터구조">데이터구조 </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#예제1">예제1 </a>
<ul>
<li class="toc-entry toc-h3"><a href="#데이터-정리">데이터 정리 </a></li>
<li class="toc-entry toc-h3"><a href="#풀이1:-은닉층을-포함한-신경망">풀이1: 은닉층을 포함한 신경망 </a></li>
<li class="toc-entry toc-h3"><a href="#풀이2:-옵티마이저-개선">풀이2: 옵티마이저 개선 </a></li>
<li class="toc-entry toc-h3"><a href="#풀이3:-컴파일시-metrics=['accuracy']-추가">풀이3: 컴파일시 metrics=[&#39;accuracy&#39;] 추가 </a></li>
<li class="toc-entry toc-h3"><a href="#풀이4:-확률적경사하강법-이용">풀이4: 확률적경사하강법 이용 </a></li>
<li class="toc-entry toc-h3"><a href="#yhat을-만드는-과정-복습">yhat을 만드는 과정 복습 </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#예제2">예제2 </a>
<ul>
<li class="toc-entry toc-h3"><a href="#데이터정리">데이터정리 </a></li>
<li class="toc-entry toc-h3"><a href="#풀이1:-아까-예제1-정도의-모델로!">풀이1: 아까 예제1 정도의 모델로! </a></li>
<li class="toc-entry toc-h3"><a href="#풀이2:-더-깊은-신경망">풀이2: 더 깊은 신경망 </a></li>
<li class="toc-entry toc-h3"><a href="#데이터-다시-정리-(데이터-자체를-2D로-해석하자)">데이터 다시 정리 (데이터 자체를 2D로 해석하자) </a></li>
<li class="toc-entry toc-h3"><a href="#풀이3:-CNN">풀이3: CNN </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-05-02-(9주차) 5월2일_draft.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="import">
<a class="anchor" href="#import" aria-hidden="true"><span class="octicon octicon-link"></span></a>import<a class="anchor-link" href="#import"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">list_physical_devices</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[PhysicalDevice(name='/physical_device:CPU:0', device_type='CPU')]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">graphviz</span>
<span class="k">def</span> <span class="nf">gv</span><span class="p">(</span><span class="n">s</span><span class="p">):</span> <span class="k">return</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="s1">'digraph G{ rankdir="LR"'</span><span class="o">+</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">';}'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="경사하강법과-확률적경사하강법">
<a class="anchor" href="#%EA%B2%BD%EC%82%AC%ED%95%98%EA%B0%95%EB%B2%95%EA%B3%BC-%ED%99%95%EB%A5%A0%EC%A0%81%EA%B2%BD%EC%82%AC%ED%95%98%EA%B0%95%EB%B2%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>경사하강법과 확률적경사하강법<a class="anchor-link" href="#%EA%B2%BD%EC%82%AC%ED%95%98%EA%B0%95%EB%B2%95%EA%B3%BC-%ED%99%95%EB%A5%A0%EC%A0%81%EA%B2%BD%EC%82%AC%ED%95%98%EA%B0%95%EB%B2%95"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 10개의 샘플이 있다고 가정</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ver1:-모든-샘플을-사용하여-slope계산">
<a class="anchor" href="#ver1:-%EB%AA%A8%EB%93%A0-%EC%83%98%ED%94%8C%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-slope%EA%B3%84%EC%82%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>ver1: 모든 샘플을 사용하여 slope계산<a class="anchor-link" href="#ver1:-%EB%AA%A8%EB%93%A0-%EC%83%98%ED%94%8C%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-slope%EA%B3%84%EC%82%B0"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(epoch1) $loss=\sum_{i=1}^{10}(y_i-\beta_0-\beta_1x_i)^2 \quad \to \quad slope \quad \to \quad update$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(epoch2) $loss=\sum_{i=1}^{10}(y_i-\beta_0-\beta_1x_i)^2 \quad \to \quad slope \quad \to \quad update$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ver2:-하나의-샘플만-사용하여-slope계산">
<a class="anchor" href="#ver2:-%ED%95%98%EB%82%98%EC%9D%98-%EC%83%98%ED%94%8C%EB%A7%8C-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-slope%EA%B3%84%EC%82%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>ver2: 하나의 샘플만 사용하여 slope계산<a class="anchor-link" href="#ver2:-%ED%95%98%EB%82%98%EC%9D%98-%EC%83%98%ED%94%8C%EB%A7%8C-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-slope%EA%B3%84%EC%82%B0"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(epoch1)</p>
<ul>
<li>$loss=(y_1-\beta_0-\beta_1x_1)^2 \quad \to \quad slope \quad \to \quad update$</li>
<li>$loss=(y_2-\beta_0-\beta_1x_1)^2 \quad \to \quad slope \quad \to \quad update$</li>
<li>...</li>
<li>$loss=(y_{10}-\beta_0-\beta_1x_{10})^2 \quad \to \quad slope \quad \to \quad update$</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(epoch2)</p>
<ul>
<li>$loss=(y_1-\beta_0-\beta_1x_1)^2 \quad \to \quad slope \quad \to \quad update$</li>
<li>$loss=(y_2-\beta_0-\beta_1x_1)^2 \quad \to \quad slope \quad \to \quad update$</li>
<li>...</li>
<li>$loss=(y_{10}-\beta_0-\beta_1x_{10})^2 \quad \to \quad slope \quad \to \quad update$</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ver3:-$m(\leq-n)$개의-샘플만-사용하여-slope계산">
<a class="anchor" href="#ver3:-%24m(%5Cleq-n)%24%EA%B0%9C%EC%9D%98-%EC%83%98%ED%94%8C%EB%A7%8C-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-slope%EA%B3%84%EC%82%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>ver3: $m(\leq n)$개의 샘플만 사용하여 slope계산<a class="anchor-link" href="#ver3:-%24m(%5Cleq-n)%24%EA%B0%9C%EC%9D%98-%EC%83%98%ED%94%8C%EB%A7%8C-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-slope%EA%B3%84%EC%82%B0"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$m=3$이라고 하자.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(epoch1)</p>
<ul>
<li>$loss=\sum_{i=1}^{3}(y_i-\beta_0-\beta_1x_i)^2 \quad \to \quad slope \quad \to \quad update$</li>
<li>$loss=\sum_{i=4}^{6}(y_i-\beta_0-\beta_1x_i)^2 \quad \to \quad slope \quad \to \quad update$</li>
<li>$loss=\sum_{i=7}^{9}(y_i-\beta_0-\beta_1x_i)^2 \quad \to \quad slope \quad \to \quad update$</li>
<li>$loss=(y_{10}-\beta_0-\beta_1x_{10})^2 \quad \to \quad slope \quad \to \quad update$</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(epoch2)</p>
<ul>
<li>$loss=\sum_{i=1}^{3}(y_i-\beta_0-\beta_1x_i)^2 \quad \to \quad slope \quad \to \quad update$</li>
<li>$loss=\sum_{i=4}^{6}(y_i-\beta_0-\beta_1x_i)^2 \quad \to \quad slope \quad \to \quad update$</li>
<li>$loss=\sum_{i=7}^{9}(y_i-\beta_0-\beta_1x_i)^2 \quad \to \quad slope \quad \to \quad update$</li>
<li>$loss=(y_{10}-\beta_0-\beta_1x_{10})^2 \quad \to \quad slope \quad \to \quad update$</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="용어의-정리">
<a class="anchor" href="#%EC%9A%A9%EC%96%B4%EC%9D%98-%EC%A0%95%EB%A6%AC" aria-hidden="true"><span class="octicon octicon-link"></span></a>용어의 정리<a class="anchor-link" href="#%EC%9A%A9%EC%96%B4%EC%9D%98-%EC%A0%95%EB%A6%AC"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="옛날-(좀-더-엄밀)">
<a class="anchor" href="#%EC%98%9B%EB%82%A0-(%EC%A2%80-%EB%8D%94-%EC%97%84%EB%B0%80)" aria-hidden="true"><span class="octicon octicon-link"></span></a>옛날 (좀 더 엄밀)<a class="anchor-link" href="#%EC%98%9B%EB%82%A0-(%EC%A2%80-%EB%8D%94-%EC%97%84%EB%B0%80)"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> ver1: gradient descent, batch gradient descent</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> ver2: stochastic gradient descent</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> ver3: mini-batch gradient descent, mini-batch stochastic gradient descent</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="요즘">
<a class="anchor" href="#%EC%9A%94%EC%A6%98" aria-hidden="true"><span class="octicon octicon-link"></span></a>요즘<a class="anchor-link" href="#%EC%9A%94%EC%A6%98"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> ver1: gradient descent</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> ver2: stochastic gradient descent with batch size = 1</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> ver3: stochastic gradient descent</p>
<ul>
<li>
<a href="https://www.deeplearningbook.org/contents/optimization.html">https://www.deeplearningbook.org/contents/optimization.html</a>, 알고리즘 8-1 참고. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>note: 이렇게 많이 쓰는 이유? ver1,2는 사실상 없는 방법이므로</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ver1,2,3-이외에-좀-더-지저분한-것들이-있다.">
<a class="anchor" href="#ver1,2,3-%EC%9D%B4%EC%99%B8%EC%97%90-%EC%A2%80-%EB%8D%94-%EC%A7%80%EC%A0%80%EB%B6%84%ED%95%9C-%EA%B2%83%EB%93%A4%EC%9D%B4-%EC%9E%88%EB%8B%A4." aria-hidden="true"><span class="octicon octicon-link"></span></a>ver1,2,3 이외에 좀 더 지저분한 것들이 있다.<a class="anchor-link" href="#ver1,2,3-%EC%9D%B4%EC%99%B8%EC%97%90-%EC%A2%80-%EB%8D%94-%EC%A7%80%EC%A0%80%EB%B6%84%ED%95%9C-%EA%B2%83%EB%93%A4%EC%9D%B4-%EC%9E%88%EB%8B%A4."> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> ver2,3에서 샘플을 셔플할 수도 있다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> ver3에서 일부 샘플이 학습에 참여 안하는 버전도 있다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 개인적 생각: 너무 더럽다 그냥.. (딱히 엄청난 효과가 있는것도 아니고 각 방법마다 이론이 있는것도 아님)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Discussion">
<a class="anchor" href="#Discussion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Discussion<a class="anchor-link" href="#Discussion"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 핵심개념</p>
<ul>
<li><strong>메모리사용량: ver1 &gt; ver3 &gt; ver2</strong></li>
<li>계산속도: ver1 &gt; ver3 &gt; ver2 </li>
<li>local-min에 갇힘: ver1 &gt; ver3 &gt; ver2</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 본질: GPU 메모리가 한정되어 있어서 ver1을 쓰지는 못한다. GPU 메모리를 가장 적게쓰는것은 ver2인데 이것은 너무 불안정하다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 틀리진 않지만 어색한 블로그 정리 내용들</p>
<ul>
<li>경사하강법은 종종 국소최소점에 갇히는 문제가 있다. 이를 해결하기 위해서 등장한 방법이 확률적 경사하강법이다. </li>
<li>경사하강법은 계산시간이 오래걸린다. 계산을 빠르게 하기 위해서 등장한 방법이 확률적 경사하강법이다.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="fashion_mnist-모듈">
<a class="anchor" href="#fashion_mnist-%EB%AA%A8%EB%93%88" aria-hidden="true"><span class="octicon octicon-link"></span></a>fashion_mnist 모듈<a class="anchor-link" href="#fashion_mnist-%EB%AA%A8%EB%93%88"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="tf.keras.datasets.fashion_mnist.load_data()">
<a class="anchor" href="#tf.keras.datasets.fashion_mnist.load_data()" aria-hidden="true"><span class="octicon octicon-link"></span></a>tf.keras.datasets.fashion_mnist.load_data()<a class="anchor-link" href="#tf.keras.datasets.fashion_mnist.load_data()"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>tf.keras.datasets.fashion_mnist.load_data<span class="o">??</span>
<span class="c1">## return (x_train, y_train), (x_test, y_test) 이것이 리턴된다. </span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre><span class="ansi-red-fg">Signature:</span> tf<span class="ansi-blue-fg">.</span>keras<span class="ansi-blue-fg">.</span>datasets<span class="ansi-blue-fg">.</span>fashion_mnist<span class="ansi-blue-fg">.</span>load_data<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Source:</span>   
<span class="ansi-blue-fg">@</span>keras_export<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'keras.datasets.fashion_mnist.load_data'</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">def</span> load_data<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
  <span class="ansi-blue-fg">"""Loads the Fashion-MNIST dataset.</span>

<span class="ansi-blue-fg">  This is a dataset of 60,000 28x28 grayscale images of 10 fashion categories,</span>
<span class="ansi-blue-fg">  along with a test set of 10,000 images. This dataset can be used as</span>
<span class="ansi-blue-fg">  a drop-in replacement for MNIST.</span>

<span class="ansi-blue-fg">  The classes are:</span>

<span class="ansi-blue-fg">  | Label | Description |</span>
<span class="ansi-blue-fg">  |:-----:|-------------|</span>
<span class="ansi-blue-fg">  |   0   | T-shirt/top |</span>
<span class="ansi-blue-fg">  |   1   | Trouser     |</span>
<span class="ansi-blue-fg">  |   2   | Pullover    |</span>
<span class="ansi-blue-fg">  |   3   | Dress       |</span>
<span class="ansi-blue-fg">  |   4   | Coat        |</span>
<span class="ansi-blue-fg">  |   5   | Sandal      |</span>
<span class="ansi-blue-fg">  |   6   | Shirt       |</span>
<span class="ansi-blue-fg">  |   7   | Sneaker     |</span>
<span class="ansi-blue-fg">  |   8   | Bag         |</span>
<span class="ansi-blue-fg">  |   9   | Ankle boot  |</span>

<span class="ansi-blue-fg">  Returns:</span>
<span class="ansi-blue-fg">    Tuple of NumPy arrays: `(x_train, y_train), (x_test, y_test)`.</span>

<span class="ansi-blue-fg">  **x_train**: uint8 NumPy array of grayscale image data with shapes</span>
<span class="ansi-blue-fg">    `(60000, 28, 28)`, containing the training data.</span>

<span class="ansi-blue-fg">  **y_train**: uint8 NumPy array of labels (integers in range 0-9)</span>
<span class="ansi-blue-fg">    with shape `(60000,)` for the training data.</span>

<span class="ansi-blue-fg">  **x_test**: uint8 NumPy array of grayscale image data with shapes</span>
<span class="ansi-blue-fg">    (10000, 28, 28), containing the test data.</span>

<span class="ansi-blue-fg">  **y_test**: uint8 NumPy array of labels (integers in range 0-9)</span>
<span class="ansi-blue-fg">    with shape `(10000,)` for the test data.</span>

<span class="ansi-blue-fg">  Example:</span>

<span class="ansi-blue-fg">  ```python</span>
<span class="ansi-blue-fg">  (x_train, y_train), (x_test, y_test) = fashion_mnist.load_data()</span>
<span class="ansi-blue-fg">  assert x_train.shape == (60000, 28, 28)</span>
<span class="ansi-blue-fg">  assert x_test.shape == (10000, 28, 28)</span>
<span class="ansi-blue-fg">  assert y_train.shape == (60000,)</span>
<span class="ansi-blue-fg">  assert y_test.shape == (10000,)</span>
<span class="ansi-blue-fg">  ```</span>

<span class="ansi-blue-fg">  License:</span>
<span class="ansi-blue-fg">    The copyright for Fashion-MNIST is held by Zalando SE.</span>
<span class="ansi-blue-fg">    Fashion-MNIST is licensed under the [MIT license](</span>
<span class="ansi-blue-fg">    https://github.com/zalandoresearch/fashion-mnist/blob/master/LICENSE).</span>

<span class="ansi-blue-fg">  """</span>
  dirname <span class="ansi-blue-fg">=</span> os<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">.</span>join<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'datasets'</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'fashion-mnist'</span><span class="ansi-blue-fg">)</span>
  base <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">'https://storage.googleapis.com/tensorflow/tf-keras-datasets/'</span>
  files <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>
      <span class="ansi-blue-fg">'train-labels-idx1-ubyte.gz'</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'train-images-idx3-ubyte.gz'</span><span class="ansi-blue-fg">,</span>
      <span class="ansi-blue-fg">'t10k-labels-idx1-ubyte.gz'</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'t10k-images-idx3-ubyte.gz'</span>
  <span class="ansi-blue-fg">]</span>

  paths <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>
  <span class="ansi-green-fg">for</span> fname <span class="ansi-green-fg">in</span> files<span class="ansi-blue-fg">:</span>
    paths<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>get_file<span class="ansi-blue-fg">(</span>fname<span class="ansi-blue-fg">,</span> origin<span class="ansi-blue-fg">=</span>base <span class="ansi-blue-fg">+</span> fname<span class="ansi-blue-fg">,</span> cache_subdir<span class="ansi-blue-fg">=</span>dirname<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

  <span class="ansi-green-fg">with</span> gzip<span class="ansi-blue-fg">.</span>open<span class="ansi-blue-fg">(</span>paths<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'rb'</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> lbpath<span class="ansi-blue-fg">:</span>
    y_train <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>frombuffer<span class="ansi-blue-fg">(</span>lbpath<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> np<span class="ansi-blue-fg">.</span>uint8<span class="ansi-blue-fg">,</span> offset<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">8</span><span class="ansi-blue-fg">)</span>

  <span class="ansi-green-fg">with</span> gzip<span class="ansi-blue-fg">.</span>open<span class="ansi-blue-fg">(</span>paths<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'rb'</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> imgpath<span class="ansi-blue-fg">:</span>
    x_train <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>frombuffer<span class="ansi-blue-fg">(</span>
        imgpath<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> np<span class="ansi-blue-fg">.</span>uint8<span class="ansi-blue-fg">,</span> offset<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">16</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>reshape<span class="ansi-blue-fg">(</span>len<span class="ansi-blue-fg">(</span>y_train<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">28</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">28</span><span class="ansi-blue-fg">)</span>

  <span class="ansi-green-fg">with</span> gzip<span class="ansi-blue-fg">.</span>open<span class="ansi-blue-fg">(</span>paths<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'rb'</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> lbpath<span class="ansi-blue-fg">:</span>
    y_test <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>frombuffer<span class="ansi-blue-fg">(</span>lbpath<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> np<span class="ansi-blue-fg">.</span>uint8<span class="ansi-blue-fg">,</span> offset<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">8</span><span class="ansi-blue-fg">)</span>

  <span class="ansi-green-fg">with</span> gzip<span class="ansi-blue-fg">.</span>open<span class="ansi-blue-fg">(</span>paths<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'rb'</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> imgpath<span class="ansi-blue-fg">:</span>
    x_test <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>frombuffer<span class="ansi-blue-fg">(</span>
        imgpath<span class="ansi-blue-fg">.</span>read<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> np<span class="ansi-blue-fg">.</span>uint8<span class="ansi-blue-fg">,</span> offset<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">16</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>reshape<span class="ansi-blue-fg">(</span>len<span class="ansi-blue-fg">(</span>y_test<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">28</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">28</span><span class="ansi-blue-fg">)</span>

  <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">(</span>x_train<span class="ansi-blue-fg">,</span> y_train<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">(</span>x_test<span class="ansi-blue-fg">,</span> y_test<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">File:</span>      ~/anaconda3/envs/tfcpu/lib/python3.9/site-packages/keras/datasets/fashion_mnist.py
<span class="ansi-red-fg">Type:</span>      function
</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="데이터생성-및-탐색">
<a class="anchor" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%83%9D%EC%84%B1-%EB%B0%8F-%ED%83%90%EC%83%89" aria-hidden="true"><span class="octicon octicon-link"></span></a>데이터생성 및 탐색<a class="anchor-link" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%83%9D%EC%84%B1-%EB%B0%8F-%ED%83%90%EC%83%89"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> tf.keras.datasets.fashion_mnist.load_data()를 이용한 데이터 생성</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fashion_mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> X[0]</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x7f1a00393d00&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 신발=9 </span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>9</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_train</span><span class="o">==</span><span class="mi">9</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([    0,    11,    15, ..., 59932, 59970, 59978]),)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x7f1a00289af0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="데이터구조">
<a class="anchor" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EA%B5%AC%EC%A1%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>데이터구조<a class="anchor-link" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EA%B5%AC%EC%A1%B0"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> ${\bf X}$: (60000,28,28)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> ${\bf y}$: (60000,1) $y=0,1,2,\dots,9$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="예제1">
<a class="anchor" href="#%EC%98%88%EC%A0%9C1" aria-hidden="true"><span class="octicon octicon-link"></span></a>예제1<a class="anchor-link" href="#%EC%98%88%EC%A0%9C1"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="데이터-정리">
<a class="anchor" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%95%EB%A6%AC" aria-hidden="true"><span class="octicon octicon-link"></span></a>데이터 정리<a class="anchor-link" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%95%EB%A6%AC"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> y=0,1에 대응하는 이미지만 정리하자. (우리가 배운건 로지스틱이니깐)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(예비학습코드)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,])</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ True,  True,  True, False])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">x_train</span><span class="p">[(</span><span class="n">y_train</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">y_train</span><span class="o">==</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">[(</span><span class="n">y_train</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">y_train</span><span class="o">==</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">XX</span> <span class="o">=</span> <span class="n">x_test</span><span class="p">[(</span><span class="n">y_test</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">y_test</span><span class="o">==</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">[(</span><span class="n">y_test</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">y_test</span><span class="o">==</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43054</span><span class="p">)</span> <span class="c1"># 43054</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span> 
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'sgd'</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">binary_crossentropy</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">12000</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/500
1/1 [==============================] - 0s 127ms/step - loss: 23.6410
Epoch 2/500
1/1 [==============================] - 0s 9ms/step - loss: 2048.4263
Epoch 3/500
1/1 [==============================] - 0s 9ms/step - loss: 10669.9619
Epoch 4/500
1/1 [==============================] - 0s 8ms/step - loss: 1531.8005
Epoch 5/500
1/1 [==============================] - 0s 8ms/step - loss: 555.8582
Epoch 6/500
1/1 [==============================] - 0s 7ms/step - loss: 214.4529
Epoch 7/500
1/1 [==============================] - 0s 8ms/step - loss: 180.1079
Epoch 8/500
1/1 [==============================] - 0s 7ms/step - loss: 167.2022
Epoch 9/500
1/1 [==============================] - 0s 11ms/step - loss: 156.5931
Epoch 10/500
1/1 [==============================] - 0s 8ms/step - loss: 146.5200
Epoch 11/500
1/1 [==============================] - 0s 8ms/step - loss: 137.1044
Epoch 12/500
1/1 [==============================] - 0s 8ms/step - loss: 128.0815
Epoch 13/500
1/1 [==============================] - 0s 8ms/step - loss: 119.5212
Epoch 14/500
1/1 [==============================] - 0s 8ms/step - loss: 111.5827
Epoch 15/500
1/1 [==============================] - 0s 7ms/step - loss: 104.1148
Epoch 16/500
1/1 [==============================] - 0s 8ms/step - loss: 96.9765
Epoch 17/500
1/1 [==============================] - 0s 7ms/step - loss: 90.3458
Epoch 18/500
1/1 [==============================] - 0s 7ms/step - loss: 84.0865
Epoch 19/500
1/1 [==============================] - 0s 7ms/step - loss: 78.1252
Epoch 20/500
1/1 [==============================] - 0s 8ms/step - loss: 72.5840
Epoch 21/500
1/1 [==============================] - 0s 8ms/step - loss: 67.4975
Epoch 22/500
1/1 [==============================] - 0s 7ms/step - loss: 62.9853
Epoch 23/500
1/1 [==============================] - 0s 7ms/step - loss: 58.9644
Epoch 24/500
1/1 [==============================] - 0s 7ms/step - loss: 55.3759
Epoch 25/500
1/1 [==============================] - 0s 7ms/step - loss: 52.3667
Epoch 26/500
1/1 [==============================] - 0s 7ms/step - loss: 49.7979
Epoch 27/500
1/1 [==============================] - 0s 7ms/step - loss: 47.5673
Epoch 28/500
1/1 [==============================] - 0s 7ms/step - loss: 45.5659
Epoch 29/500
1/1 [==============================] - 0s 7ms/step - loss: 43.8587
Epoch 30/500
1/1 [==============================] - 0s 8ms/step - loss: 42.3322
Epoch 31/500
1/1 [==============================] - 0s 7ms/step - loss: 40.9888
Epoch 32/500
1/1 [==============================] - 0s 7ms/step - loss: 39.8018
Epoch 33/500
1/1 [==============================] - 0s 7ms/step - loss: 38.7252
Epoch 34/500
1/1 [==============================] - 0s 8ms/step - loss: 37.8063
Epoch 35/500
1/1 [==============================] - 0s 7ms/step - loss: 36.9741
Epoch 36/500
1/1 [==============================] - 0s 7ms/step - loss: 36.1690
Epoch 37/500
1/1 [==============================] - 0s 8ms/step - loss: 35.4357
Epoch 38/500
1/1 [==============================] - 0s 7ms/step - loss: 34.7561
Epoch 39/500
1/1 [==============================] - 0s 8ms/step - loss: 34.0973
Epoch 40/500
1/1 [==============================] - 0s 7ms/step - loss: 33.4584
Epoch 41/500
1/1 [==============================] - 0s 7ms/step - loss: 32.8509
Epoch 42/500
1/1 [==============================] - 0s 7ms/step - loss: 32.2993
Epoch 43/500
1/1 [==============================] - 0s 8ms/step - loss: 31.7840
Epoch 44/500
1/1 [==============================] - 0s 8ms/step - loss: 31.2967
Epoch 45/500
1/1 [==============================] - 0s 8ms/step - loss: 30.8339
Epoch 46/500
1/1 [==============================] - 0s 7ms/step - loss: 30.4102
Epoch 47/500
1/1 [==============================] - 0s 8ms/step - loss: 30.0138
Epoch 48/500
1/1 [==============================] - 0s 8ms/step - loss: 29.6595
Epoch 49/500
1/1 [==============================] - 0s 7ms/step - loss: 29.3112
Epoch 50/500
1/1 [==============================] - 0s 7ms/step - loss: 28.9725
Epoch 51/500
1/1 [==============================] - 0s 7ms/step - loss: 28.6508
Epoch 52/500
1/1 [==============================] - 0s 8ms/step - loss: 28.3498
Epoch 53/500
1/1 [==============================] - 0s 7ms/step - loss: 28.0604
Epoch 54/500
1/1 [==============================] - 0s 7ms/step - loss: 27.7784
Epoch 55/500
1/1 [==============================] - 0s 7ms/step - loss: 27.5052
Epoch 56/500
1/1 [==============================] - 0s 7ms/step - loss: 27.2431
Epoch 57/500
1/1 [==============================] - 0s 7ms/step - loss: 26.9899
Epoch 58/500
1/1 [==============================] - 0s 7ms/step - loss: 26.7382
Epoch 59/500
1/1 [==============================] - 0s 7ms/step - loss: 26.4874
Epoch 60/500
1/1 [==============================] - 0s 8ms/step - loss: 26.2388
Epoch 61/500
1/1 [==============================] - 0s 7ms/step - loss: 25.9942
Epoch 62/500
1/1 [==============================] - 0s 7ms/step - loss: 25.7505
Epoch 63/500
1/1 [==============================] - 0s 7ms/step - loss: 25.5094
Epoch 64/500
1/1 [==============================] - 0s 8ms/step - loss: 25.2732
Epoch 65/500
1/1 [==============================] - 0s 8ms/step - loss: 25.0436
Epoch 66/500
1/1 [==============================] - 0s 7ms/step - loss: 24.8145
Epoch 67/500
1/1 [==============================] - 0s 7ms/step - loss: 24.5894
Epoch 68/500
1/1 [==============================] - 0s 7ms/step - loss: 24.3681
Epoch 69/500
1/1 [==============================] - 0s 7ms/step - loss: 24.1549
Epoch 70/500
1/1 [==============================] - 0s 8ms/step - loss: 23.9475
Epoch 71/500
1/1 [==============================] - 0s 8ms/step - loss: 23.7474
Epoch 72/500
1/1 [==============================] - 0s 8ms/step - loss: 23.5545
Epoch 73/500
1/1 [==============================] - 0s 8ms/step - loss: 23.3672
Epoch 74/500
1/1 [==============================] - 0s 7ms/step - loss: 23.1889
Epoch 75/500
1/1 [==============================] - 0s 7ms/step - loss: 23.0168
Epoch 76/500
1/1 [==============================] - 0s 9ms/step - loss: 22.8467
Epoch 77/500
1/1 [==============================] - 0s 7ms/step - loss: 22.6770
Epoch 78/500
1/1 [==============================] - 0s 8ms/step - loss: 22.5092
Epoch 79/500
1/1 [==============================] - 0s 7ms/step - loss: 22.3451
Epoch 80/500
1/1 [==============================] - 0s 8ms/step - loss: 22.1818
Epoch 81/500
1/1 [==============================] - 0s 8ms/step - loss: 22.0196
Epoch 82/500
1/1 [==============================] - 0s 7ms/step - loss: 21.8609
Epoch 83/500
1/1 [==============================] - 0s 7ms/step - loss: 21.7032
Epoch 84/500
1/1 [==============================] - 0s 7ms/step - loss: 21.5511
Epoch 85/500
1/1 [==============================] - 0s 7ms/step - loss: 21.4016
Epoch 86/500
1/1 [==============================] - 0s 7ms/step - loss: 21.2536
Epoch 87/500
1/1 [==============================] - 0s 7ms/step - loss: 21.1112
Epoch 88/500
1/1 [==============================] - 0s 8ms/step - loss: 20.9713
Epoch 89/500
1/1 [==============================] - 0s 8ms/step - loss: 20.8367
Epoch 90/500
1/1 [==============================] - 0s 9ms/step - loss: 20.7034
Epoch 91/500
1/1 [==============================] - 0s 9ms/step - loss: 20.5720
Epoch 92/500
1/1 [==============================] - 0s 7ms/step - loss: 20.4438
Epoch 93/500
1/1 [==============================] - 0s 7ms/step - loss: 20.3184
Epoch 94/500
1/1 [==============================] - 0s 7ms/step - loss: 20.1937
Epoch 95/500
1/1 [==============================] - 0s 7ms/step - loss: 20.0713
Epoch 96/500
1/1 [==============================] - 0s 8ms/step - loss: 19.9524
Epoch 97/500
1/1 [==============================] - 0s 7ms/step - loss: 19.8347
Epoch 98/500
1/1 [==============================] - 0s 7ms/step - loss: 19.7170
Epoch 99/500
1/1 [==============================] - 0s 7ms/step - loss: 19.6021
Epoch 100/500
1/1 [==============================] - 0s 8ms/step - loss: 19.4904
Epoch 101/500
1/1 [==============================] - 0s 7ms/step - loss: 19.3825
Epoch 102/500
1/1 [==============================] - 0s 7ms/step - loss: 19.2747
Epoch 103/500
1/1 [==============================] - 0s 7ms/step - loss: 19.1670
Epoch 104/500
1/1 [==============================] - 0s 7ms/step - loss: 19.0601
Epoch 105/500
1/1 [==============================] - 0s 8ms/step - loss: 18.9547
Epoch 106/500
1/1 [==============================] - 0s 7ms/step - loss: 18.8510
Epoch 107/500
1/1 [==============================] - 0s 8ms/step - loss: 18.7502
Epoch 108/500
1/1 [==============================] - 0s 8ms/step - loss: 18.6533
Epoch 109/500
1/1 [==============================] - 0s 8ms/step - loss: 18.5577
Epoch 110/500
1/1 [==============================] - 0s 8ms/step - loss: 18.4622
Epoch 111/500
1/1 [==============================] - 0s 8ms/step - loss: 18.3671
Epoch 112/500
1/1 [==============================] - 0s 7ms/step - loss: 18.2739
Epoch 113/500
1/1 [==============================] - 0s 8ms/step - loss: 18.1826
Epoch 114/500
1/1 [==============================] - 0s 8ms/step - loss: 18.0918
Epoch 115/500
1/1 [==============================] - 0s 8ms/step - loss: 18.0015
Epoch 116/500
1/1 [==============================] - 0s 8ms/step - loss: 17.9134
Epoch 117/500
1/1 [==============================] - 0s 7ms/step - loss: 17.8254
Epoch 118/500
1/1 [==============================] - 0s 7ms/step - loss: 17.7390
Epoch 119/500
1/1 [==============================] - 0s 7ms/step - loss: 17.6575
Epoch 120/500
1/1 [==============================] - 0s 7ms/step - loss: 17.5804
Epoch 121/500
1/1 [==============================] - 0s 7ms/step - loss: 17.5043
Epoch 122/500
1/1 [==============================] - 0s 7ms/step - loss: 17.4283
Epoch 123/500
1/1 [==============================] - 0s 7ms/step - loss: 17.3522
Epoch 124/500
1/1 [==============================] - 0s 7ms/step - loss: 17.2761
Epoch 125/500
1/1 [==============================] - 0s 7ms/step - loss: 17.2002
Epoch 126/500
1/1 [==============================] - 0s 7ms/step - loss: 17.1245
Epoch 127/500
1/1 [==============================] - 0s 7ms/step - loss: 17.0494
Epoch 128/500
1/1 [==============================] - 0s 7ms/step - loss: 16.9746
Epoch 129/500
1/1 [==============================] - 0s 7ms/step - loss: 16.9003
Epoch 130/500
1/1 [==============================] - 0s 8ms/step - loss: 16.8261
Epoch 131/500
1/1 [==============================] - 0s 7ms/step - loss: 16.7522
Epoch 132/500
1/1 [==============================] - 0s 7ms/step - loss: 16.6783
Epoch 133/500
1/1 [==============================] - 0s 7ms/step - loss: 16.6044
Epoch 134/500
1/1 [==============================] - 0s 7ms/step - loss: 16.5306
Epoch 135/500
1/1 [==============================] - 0s 7ms/step - loss: 16.4569
Epoch 136/500
1/1 [==============================] - 0s 7ms/step - loss: 16.3834
Epoch 137/500
1/1 [==============================] - 0s 7ms/step - loss: 16.3104
Epoch 138/500
1/1 [==============================] - 0s 8ms/step - loss: 16.2394
Epoch 139/500
1/1 [==============================] - 0s 7ms/step - loss: 16.1727
Epoch 140/500
1/1 [==============================] - 0s 8ms/step - loss: 16.1037
Epoch 141/500
1/1 [==============================] - 0s 7ms/step - loss: 16.0310
Epoch 142/500
1/1 [==============================] - 0s 7ms/step - loss: 15.9625
Epoch 143/500
1/1 [==============================] - 0s 7ms/step - loss: 15.8940
Epoch 144/500
1/1 [==============================] - 0s 7ms/step - loss: 15.8258
Epoch 145/500
1/1 [==============================] - 0s 8ms/step - loss: 15.7584
Epoch 146/500
1/1 [==============================] - 0s 7ms/step - loss: 15.6920
Epoch 147/500
1/1 [==============================] - 0s 7ms/step - loss: 15.6264
Epoch 148/500
1/1 [==============================] - 0s 8ms/step - loss: 15.5610
Epoch 149/500
1/1 [==============================] - 0s 8ms/step - loss: 15.4911
Epoch 150/500
1/1 [==============================] - 0s 8ms/step - loss: 15.4264
Epoch 151/500
1/1 [==============================] - 0s 7ms/step - loss: 15.3588
Epoch 152/500
1/1 [==============================] - 0s 7ms/step - loss: 15.2913
Epoch 153/500
1/1 [==============================] - 0s 7ms/step - loss: 15.2265
Epoch 154/500
1/1 [==============================] - 0s 7ms/step - loss: 15.1599
Epoch 155/500
1/1 [==============================] - 0s 8ms/step - loss: 15.0952
Epoch 156/500
1/1 [==============================] - 0s 7ms/step - loss: 15.0297
Epoch 157/500
1/1 [==============================] - 0s 7ms/step - loss: 14.9645
Epoch 158/500
1/1 [==============================] - 0s 7ms/step - loss: 14.8991
Epoch 159/500
1/1 [==============================] - 0s 7ms/step - loss: 14.8343
Epoch 160/500
1/1 [==============================] - 0s 7ms/step - loss: 14.7700
Epoch 161/500
1/1 [==============================] - 0s 7ms/step - loss: 14.7068
Epoch 162/500
1/1 [==============================] - 0s 8ms/step - loss: 14.6408
Epoch 163/500
1/1 [==============================] - 0s 7ms/step - loss: 14.5766
Epoch 164/500
1/1 [==============================] - 0s 7ms/step - loss: 14.5129
Epoch 165/500
1/1 [==============================] - 0s 7ms/step - loss: 14.4500
Epoch 166/500
1/1 [==============================] - 0s 7ms/step - loss: 14.3878
Epoch 167/500
1/1 [==============================] - 0s 7ms/step - loss: 14.3285
Epoch 168/500
1/1 [==============================] - 0s 9ms/step - loss: 14.2650
Epoch 169/500
1/1 [==============================] - 0s 7ms/step - loss: 14.2049
Epoch 170/500
1/1 [==============================] - 0s 7ms/step - loss: 14.1415
Epoch 171/500
1/1 [==============================] - 0s 7ms/step - loss: 14.0802
Epoch 172/500
1/1 [==============================] - 0s 8ms/step - loss: 14.0193
Epoch 173/500
1/1 [==============================] - 0s 7ms/step - loss: 13.9587
Epoch 174/500
1/1 [==============================] - 0s 7ms/step - loss: 13.8999
Epoch 175/500
1/1 [==============================] - 0s 7ms/step - loss: 13.8421
Epoch 176/500
1/1 [==============================] - 0s 8ms/step - loss: 13.7845
Epoch 177/500
1/1 [==============================] - 0s 8ms/step - loss: 13.7274
Epoch 178/500
1/1 [==============================] - 0s 8ms/step - loss: 13.6700
Epoch 179/500
1/1 [==============================] - 0s 8ms/step - loss: 13.6126
Epoch 180/500
1/1 [==============================] - 0s 8ms/step - loss: 13.5555
Epoch 181/500
1/1 [==============================] - 0s 8ms/step - loss: 13.4980
Epoch 182/500
1/1 [==============================] - 0s 7ms/step - loss: 13.4409
Epoch 183/500
1/1 [==============================] - 0s 9ms/step - loss: 13.3840
Epoch 184/500
1/1 [==============================] - 0s 7ms/step - loss: 13.3272
Epoch 185/500
1/1 [==============================] - 0s 7ms/step - loss: 13.2705
Epoch 186/500
1/1 [==============================] - 0s 8ms/step - loss: 13.2137
Epoch 187/500
1/1 [==============================] - 0s 7ms/step - loss: 13.1570
Epoch 188/500
1/1 [==============================] - 0s 7ms/step - loss: 13.1004
Epoch 189/500
1/1 [==============================] - 0s 7ms/step - loss: 13.0439
Epoch 190/500
1/1 [==============================] - 0s 7ms/step - loss: 12.9881
Epoch 191/500
1/1 [==============================] - 0s 7ms/step - loss: 12.9331
Epoch 192/500
1/1 [==============================] - 0s 7ms/step - loss: 12.8808
Epoch 193/500
1/1 [==============================] - 0s 7ms/step - loss: 12.8255
Epoch 194/500
1/1 [==============================] - 0s 7ms/step - loss: 12.7724
Epoch 195/500
1/1 [==============================] - 0s 7ms/step - loss: 12.7165
Epoch 196/500
1/1 [==============================] - 0s 7ms/step - loss: 12.6626
Epoch 197/500
1/1 [==============================] - 0s 7ms/step - loss: 12.6072
Epoch 198/500
1/1 [==============================] - 0s 7ms/step - loss: 12.5526
Epoch 199/500
1/1 [==============================] - 0s 7ms/step - loss: 12.4974
Epoch 200/500
1/1 [==============================] - 0s 10ms/step - loss: 12.4465
Epoch 201/500
1/1 [==============================] - 0s 7ms/step - loss: 12.3963
Epoch 202/500
1/1 [==============================] - 0s 7ms/step - loss: 12.3433
Epoch 203/500
1/1 [==============================] - 0s 7ms/step - loss: 12.2918
Epoch 204/500
1/1 [==============================] - 0s 7ms/step - loss: 12.2374
Epoch 205/500
1/1 [==============================] - 0s 8ms/step - loss: 12.1862
Epoch 206/500
1/1 [==============================] - 0s 8ms/step - loss: 12.1338
Epoch 207/500
1/1 [==============================] - 0s 7ms/step - loss: 12.0846
Epoch 208/500
1/1 [==============================] - 0s 7ms/step - loss: 12.0293
Epoch 209/500
1/1 [==============================] - 0s 7ms/step - loss: 11.9830
Epoch 210/500
1/1 [==============================] - 0s 7ms/step - loss: 11.9259
Epoch 211/500
1/1 [==============================] - 0s 8ms/step - loss: 11.8801
Epoch 212/500
1/1 [==============================] - 0s 7ms/step - loss: 11.8224
Epoch 213/500
1/1 [==============================] - 0s 7ms/step - loss: 11.7757
Epoch 214/500
1/1 [==============================] - 0s 8ms/step - loss: 11.7276
Epoch 215/500
1/1 [==============================] - 0s 8ms/step - loss: 11.6815
Epoch 216/500
1/1 [==============================] - 0s 7ms/step - loss: 11.6296
Epoch 217/500
1/1 [==============================] - 0s 7ms/step - loss: 11.5795
Epoch 218/500
1/1 [==============================] - 0s 7ms/step - loss: 11.5268
Epoch 219/500
1/1 [==============================] - 0s 8ms/step - loss: 11.4795
Epoch 220/500
1/1 [==============================] - 0s 8ms/step - loss: 11.4277
Epoch 221/500
1/1 [==============================] - 0s 7ms/step - loss: 11.3780
Epoch 222/500
1/1 [==============================] - 0s 8ms/step - loss: 11.3296
Epoch 223/500
1/1 [==============================] - 0s 8ms/step - loss: 11.2830
Epoch 224/500
1/1 [==============================] - 0s 9ms/step - loss: 11.2343
Epoch 225/500
1/1 [==============================] - 0s 7ms/step - loss: 11.1873
Epoch 226/500
1/1 [==============================] - 0s 7ms/step - loss: 11.1408
Epoch 227/500
1/1 [==============================] - 0s 7ms/step - loss: 11.0964
Epoch 228/500
1/1 [==============================] - 0s 7ms/step - loss: 11.0529
Epoch 229/500
1/1 [==============================] - 0s 7ms/step - loss: 11.0082
Epoch 230/500
1/1 [==============================] - 0s 7ms/step - loss: 10.9649
Epoch 231/500
1/1 [==============================] - 0s 8ms/step - loss: 10.9200
Epoch 232/500
1/1 [==============================] - 0s 8ms/step - loss: 10.8751
Epoch 233/500
1/1 [==============================] - 0s 8ms/step - loss: 10.8287
Epoch 234/500
1/1 [==============================] - 0s 8ms/step - loss: 10.7856
Epoch 235/500
1/1 [==============================] - 0s 8ms/step - loss: 10.7383
Epoch 236/500
1/1 [==============================] - 0s 7ms/step - loss: 10.6978
Epoch 237/500
1/1 [==============================] - 0s 7ms/step - loss: 10.6486
Epoch 238/500
1/1 [==============================] - 0s 8ms/step - loss: 10.6112
Epoch 239/500
1/1 [==============================] - 0s 7ms/step - loss: 10.5677
Epoch 240/500
1/1 [==============================] - 0s 7ms/step - loss: 10.5261
Epoch 241/500
1/1 [==============================] - 0s 8ms/step - loss: 10.4756
Epoch 242/500
1/1 [==============================] - 0s 8ms/step - loss: 10.4441
Epoch 243/500
1/1 [==============================] - 0s 7ms/step - loss: 10.3865
Epoch 244/500
1/1 [==============================] - 0s 8ms/step - loss: 10.3586
Epoch 245/500
1/1 [==============================] - 0s 7ms/step - loss: 10.2966
Epoch 246/500
1/1 [==============================] - 0s 8ms/step - loss: 10.2673
Epoch 247/500
1/1 [==============================] - 0s 7ms/step - loss: 10.2128
Epoch 248/500
1/1 [==============================] - 0s 7ms/step - loss: 10.1853
Epoch 249/500
1/1 [==============================] - 0s 8ms/step - loss: 10.1246
Epoch 250/500
1/1 [==============================] - 0s 7ms/step - loss: 10.0919
Epoch 251/500
1/1 [==============================] - 0s 8ms/step - loss: 10.0389
Epoch 252/500
1/1 [==============================] - 0s 7ms/step - loss: 9.9979
Epoch 253/500
1/1 [==============================] - 0s 7ms/step - loss: 9.9616
Epoch 254/500
1/1 [==============================] - 0s 7ms/step - loss: 9.9296
Epoch 255/500
1/1 [==============================] - 0s 7ms/step - loss: 9.8748
Epoch 256/500
1/1 [==============================] - 0s 7ms/step - loss: 9.8402
Epoch 257/500
1/1 [==============================] - 0s 8ms/step - loss: 9.7943
Epoch 258/500
1/1 [==============================] - 0s 8ms/step - loss: 9.7578
Epoch 259/500
1/1 [==============================] - 0s 8ms/step - loss: 9.7142
Epoch 260/500
1/1 [==============================] - 0s 8ms/step - loss: 9.6791
Epoch 261/500
1/1 [==============================] - 0s 8ms/step - loss: 9.6333
Epoch 262/500
1/1 [==============================] - 0s 8ms/step - loss: 9.5982
Epoch 263/500
1/1 [==============================] - 0s 8ms/step - loss: 9.5557
Epoch 264/500
1/1 [==============================] - 0s 9ms/step - loss: 9.5302
Epoch 265/500
1/1 [==============================] - 0s 8ms/step - loss: 9.4750
Epoch 266/500
1/1 [==============================] - 0s 8ms/step - loss: 9.4452
Epoch 267/500
1/1 [==============================] - 0s 8ms/step - loss: 9.4005
Epoch 268/500
1/1 [==============================] - 0s 8ms/step - loss: 9.3782
Epoch 269/500
1/1 [==============================] - 0s 8ms/step - loss: 9.3239
Epoch 270/500
1/1 [==============================] - 0s 7ms/step - loss: 9.2983
Epoch 271/500
1/1 [==============================] - 0s 7ms/step - loss: 9.2478
Epoch 272/500
1/1 [==============================] - 0s 8ms/step - loss: 9.2188
Epoch 273/500
1/1 [==============================] - 0s 7ms/step - loss: 9.1680
Epoch 274/500
1/1 [==============================] - 0s 7ms/step - loss: 9.1379
Epoch 275/500
1/1 [==============================] - 0s 7ms/step - loss: 9.0964
Epoch 276/500
1/1 [==============================] - 0s 7ms/step - loss: 9.0657
Epoch 277/500
1/1 [==============================] - 0s 7ms/step - loss: 9.0191
Epoch 278/500
1/1 [==============================] - 0s 7ms/step - loss: 8.9872
Epoch 279/500
1/1 [==============================] - 0s 7ms/step - loss: 8.9415
Epoch 280/500
1/1 [==============================] - 0s 7ms/step - loss: 8.9109
Epoch 281/500
1/1 [==============================] - 0s 8ms/step - loss: 8.8686
Epoch 282/500
1/1 [==============================] - 0s 7ms/step - loss: 8.8343
Epoch 283/500
1/1 [==============================] - 0s 7ms/step - loss: 8.7972
Epoch 284/500
1/1 [==============================] - 0s 7ms/step - loss: 8.7613
Epoch 285/500
1/1 [==============================] - 0s 7ms/step - loss: 8.7274
Epoch 286/500
1/1 [==============================] - 0s 7ms/step - loss: 8.6892
Epoch 287/500
1/1 [==============================] - 0s 8ms/step - loss: 8.6540
Epoch 288/500
1/1 [==============================] - 0s 7ms/step - loss: 8.6138
Epoch 289/500
1/1 [==============================] - 0s 8ms/step - loss: 8.5771
Epoch 290/500
1/1 [==============================] - 0s 7ms/step - loss: 8.5417
Epoch 291/500
1/1 [==============================] - 0s 7ms/step - loss: 8.5040
Epoch 292/500
1/1 [==============================] - 0s 9ms/step - loss: 8.4669
Epoch 293/500
1/1 [==============================] - 0s 8ms/step - loss: 8.4307
Epoch 294/500
1/1 [==============================] - 0s 8ms/step - loss: 8.3944
Epoch 295/500
1/1 [==============================] - 0s 7ms/step - loss: 8.3586
Epoch 296/500
1/1 [==============================] - 0s 8ms/step - loss: 8.3231
Epoch 297/500
1/1 [==============================] - 0s 7ms/step - loss: 8.2888
Epoch 298/500
1/1 [==============================] - 0s 8ms/step - loss: 8.2554
Epoch 299/500
1/1 [==============================] - 0s 7ms/step - loss: 8.2195
Epoch 300/500
1/1 [==============================] - 0s 8ms/step - loss: 8.1850
Epoch 301/500
1/1 [==============================] - 0s 8ms/step - loss: 8.1489
Epoch 302/500
1/1 [==============================] - 0s 7ms/step - loss: 8.1141
Epoch 303/500
1/1 [==============================] - 0s 7ms/step - loss: 8.0797
Epoch 304/500
1/1 [==============================] - 0s 7ms/step - loss: 8.0425
Epoch 305/500
1/1 [==============================] - 0s 7ms/step - loss: 8.0088
Epoch 306/500
1/1 [==============================] - 0s 7ms/step - loss: 7.9722
Epoch 307/500
1/1 [==============================] - 0s 8ms/step - loss: 7.9390
Epoch 308/500
1/1 [==============================] - 0s 7ms/step - loss: 7.9064
Epoch 309/500
1/1 [==============================] - 0s 7ms/step - loss: 7.8723
Epoch 310/500
1/1 [==============================] - 0s 7ms/step - loss: 7.8376
Epoch 311/500
1/1 [==============================] - 0s 7ms/step - loss: 7.8042
Epoch 312/500
1/1 [==============================] - 0s 7ms/step - loss: 7.7691
Epoch 313/500
1/1 [==============================] - 0s 8ms/step - loss: 7.7366
Epoch 314/500
1/1 [==============================] - 0s 7ms/step - loss: 7.7025
Epoch 315/500
1/1 [==============================] - 0s 7ms/step - loss: 7.6714
Epoch 316/500
1/1 [==============================] - 0s 7ms/step - loss: 7.6350
Epoch 317/500
1/1 [==============================] - 0s 7ms/step - loss: 7.6008
Epoch 318/500
1/1 [==============================] - 0s 7ms/step - loss: 7.5672
Epoch 319/500
1/1 [==============================] - 0s 8ms/step - loss: 7.5341
Epoch 320/500
1/1 [==============================] - 0s 7ms/step - loss: 7.5010
Epoch 321/500
1/1 [==============================] - 0s 7ms/step - loss: 7.4681
Epoch 322/500
1/1 [==============================] - 0s 7ms/step - loss: 7.4350
Epoch 323/500
1/1 [==============================] - 0s 8ms/step - loss: 7.4023
Epoch 324/500
1/1 [==============================] - 0s 7ms/step - loss: 7.3701
Epoch 325/500
1/1 [==============================] - 0s 7ms/step - loss: 7.3409
Epoch 326/500
1/1 [==============================] - 0s 7ms/step - loss: 7.3062
Epoch 327/500
1/1 [==============================] - 0s 7ms/step - loss: 7.2754
Epoch 328/500
1/1 [==============================] - 0s 7ms/step - loss: 7.2411
Epoch 329/500
1/1 [==============================] - 0s 7ms/step - loss: 7.2097
Epoch 330/500
1/1 [==============================] - 0s 7ms/step - loss: 7.1771
Epoch 331/500
1/1 [==============================] - 0s 7ms/step - loss: 7.1445
Epoch 332/500
1/1 [==============================] - 0s 7ms/step - loss: 7.1127
Epoch 333/500
1/1 [==============================] - 0s 7ms/step - loss: 7.0809
Epoch 334/500
1/1 [==============================] - 0s 8ms/step - loss: 7.0497
Epoch 335/500
1/1 [==============================] - 0s 7ms/step - loss: 7.0196
Epoch 336/500
1/1 [==============================] - 0s 8ms/step - loss: 6.9888
Epoch 337/500
1/1 [==============================] - 0s 7ms/step - loss: 6.9611
Epoch 338/500
1/1 [==============================] - 0s 7ms/step - loss: 6.9235
Epoch 339/500
1/1 [==============================] - 0s 7ms/step - loss: 6.8911
Epoch 340/500
1/1 [==============================] - 0s 7ms/step - loss: 6.8572
Epoch 341/500
1/1 [==============================] - 0s 8ms/step - loss: 6.8263
Epoch 342/500
1/1 [==============================] - 0s 7ms/step - loss: 6.7953
Epoch 343/500
1/1 [==============================] - 0s 8ms/step - loss: 6.7690
Epoch 344/500
1/1 [==============================] - 0s 8ms/step - loss: 6.7391
Epoch 345/500
1/1 [==============================] - 0s 7ms/step - loss: 6.7188
Epoch 346/500
1/1 [==============================] - 0s 7ms/step - loss: 6.6803
Epoch 347/500
1/1 [==============================] - 0s 8ms/step - loss: 6.6612
Epoch 348/500
1/1 [==============================] - 0s 7ms/step - loss: 6.6258
Epoch 349/500
1/1 [==============================] - 0s 7ms/step - loss: 6.6101
Epoch 350/500
1/1 [==============================] - 0s 8ms/step - loss: 6.5947
Epoch 351/500
1/1 [==============================] - 0s 8ms/step - loss: 6.5502
Epoch 352/500
1/1 [==============================] - 0s 8ms/step - loss: 6.5195
Epoch 353/500
1/1 [==============================] - 0s 8ms/step - loss: 6.4873
Epoch 354/500
1/1 [==============================] - 0s 8ms/step - loss: 6.4522
Epoch 355/500
1/1 [==============================] - 0s 8ms/step - loss: 6.4311
Epoch 356/500
1/1 [==============================] - 0s 8ms/step - loss: 6.4030
Epoch 357/500
1/1 [==============================] - 0s 8ms/step - loss: 6.3720
Epoch 358/500
1/1 [==============================] - 0s 7ms/step - loss: 6.3465
Epoch 359/500
1/1 [==============================] - 0s 7ms/step - loss: 6.3207
Epoch 360/500
1/1 [==============================] - 0s 7ms/step - loss: 6.2982
Epoch 361/500
1/1 [==============================] - 0s 8ms/step - loss: 6.2691
Epoch 362/500
1/1 [==============================] - 0s 8ms/step - loss: 6.2450
Epoch 363/500
1/1 [==============================] - 0s 8ms/step - loss: 6.2198
Epoch 364/500
1/1 [==============================] - 0s 7ms/step - loss: 6.2069
Epoch 365/500
1/1 [==============================] - 0s 7ms/step - loss: 6.1774
Epoch 366/500
1/1 [==============================] - 0s 7ms/step - loss: 6.1543
Epoch 367/500
1/1 [==============================] - 0s 7ms/step - loss: 6.1290
Epoch 368/500
1/1 [==============================] - 0s 7ms/step - loss: 6.0949
Epoch 369/500
1/1 [==============================] - 0s 8ms/step - loss: 6.0518
Epoch 370/500
1/1 [==============================] - 0s 7ms/step - loss: 6.0349
Epoch 371/500
1/1 [==============================] - 0s 7ms/step - loss: 6.0015
Epoch 372/500
1/1 [==============================] - 0s 7ms/step - loss: 5.9843
Epoch 373/500
1/1 [==============================] - 0s 8ms/step - loss: 5.9514
Epoch 374/500
1/1 [==============================] - 0s 8ms/step - loss: 5.9368
Epoch 375/500
1/1 [==============================] - 0s 8ms/step - loss: 5.9074
Epoch 376/500
1/1 [==============================] - 0s 7ms/step - loss: 5.8872
Epoch 377/500
1/1 [==============================] - 0s 7ms/step - loss: 5.8695
Epoch 378/500
1/1 [==============================] - 0s 7ms/step - loss: 5.8393
Epoch 379/500
1/1 [==============================] - 0s 7ms/step - loss: 5.8211
Epoch 380/500
1/1 [==============================] - 0s 7ms/step - loss: 5.7896
Epoch 381/500
1/1 [==============================] - 0s 7ms/step - loss: 5.7685
Epoch 382/500
1/1 [==============================] - 0s 8ms/step - loss: 5.7476
Epoch 383/500
1/1 [==============================] - 0s 7ms/step - loss: 5.7294
Epoch 384/500
1/1 [==============================] - 0s 7ms/step - loss: 5.7004
Epoch 385/500
1/1 [==============================] - 0s 7ms/step - loss: 5.6795
Epoch 386/500
1/1 [==============================] - 0s 8ms/step - loss: 5.6481
Epoch 387/500
1/1 [==============================] - 0s 7ms/step - loss: 5.6304
Epoch 388/500
1/1 [==============================] - 0s 7ms/step - loss: 5.5927
Epoch 389/500
1/1 [==============================] - 0s 7ms/step - loss: 5.5671
Epoch 390/500
1/1 [==============================] - 0s 7ms/step - loss: 5.5430
Epoch 391/500
1/1 [==============================] - 0s 7ms/step - loss: 5.5254
Epoch 392/500
1/1 [==============================] - 0s 7ms/step - loss: 5.4912
Epoch 393/500
1/1 [==============================] - 0s 7ms/step - loss: 5.4790
Epoch 394/500
1/1 [==============================] - 0s 7ms/step - loss: 5.4471
Epoch 395/500
1/1 [==============================] - 0s 8ms/step - loss: 5.4429
Epoch 396/500
1/1 [==============================] - 0s 7ms/step - loss: 5.4138
Epoch 397/500
1/1 [==============================] - 0s 8ms/step - loss: 5.4230
Epoch 398/500
1/1 [==============================] - 0s 8ms/step - loss: 5.4144
Epoch 399/500
1/1 [==============================] - 0s 8ms/step - loss: 5.3809
Epoch 400/500
1/1 [==============================] - 0s 7ms/step - loss: 5.3711
Epoch 401/500
1/1 [==============================] - 0s 8ms/step - loss: 5.3423
Epoch 402/500
1/1 [==============================] - 0s 8ms/step - loss: 5.3477
Epoch 403/500
1/1 [==============================] - 0s 8ms/step - loss: 5.3169
Epoch 404/500
1/1 [==============================] - 0s 8ms/step - loss: 5.3268
Epoch 405/500
1/1 [==============================] - 0s 7ms/step - loss: 5.2444
Epoch 406/500
1/1 [==============================] - 0s 7ms/step - loss: 5.2248
Epoch 407/500
1/1 [==============================] - 0s 7ms/step - loss: 5.2040
Epoch 408/500
1/1 [==============================] - 0s 8ms/step - loss: 5.1840
Epoch 409/500
1/1 [==============================] - 0s 8ms/step - loss: 5.1574
Epoch 410/500
1/1 [==============================] - 0s 8ms/step - loss: 5.1194
Epoch 411/500
1/1 [==============================] - 0s 8ms/step - loss: 5.1052
Epoch 412/500
1/1 [==============================] - 0s 7ms/step - loss: 5.0710
Epoch 413/500
1/1 [==============================] - 0s 7ms/step - loss: 5.0515
Epoch 414/500
1/1 [==============================] - 0s 8ms/step - loss: 5.0368
Epoch 415/500
1/1 [==============================] - 0s 8ms/step - loss: 5.0173
Epoch 416/500
1/1 [==============================] - 0s 7ms/step - loss: 4.9935
Epoch 417/500
1/1 [==============================] - 0s 8ms/step - loss: 4.9638
Epoch 418/500
1/1 [==============================] - 0s 7ms/step - loss: 4.9531
Epoch 419/500
1/1 [==============================] - 0s 7ms/step - loss: 4.9202
Epoch 420/500
1/1 [==============================] - 0s 7ms/step - loss: 4.9028
Epoch 421/500
1/1 [==============================] - 0s 8ms/step - loss: 4.8757
Epoch 422/500
1/1 [==============================] - 0s 8ms/step - loss: 4.8652
Epoch 423/500
1/1 [==============================] - 0s 8ms/step - loss: 4.8335
Epoch 424/500
1/1 [==============================] - 0s 8ms/step - loss: 4.8272
Epoch 425/500
1/1 [==============================] - 0s 8ms/step - loss: 4.8004
Epoch 426/500
1/1 [==============================] - 0s 8ms/step - loss: 4.8058
Epoch 427/500
1/1 [==============================] - 0s 7ms/step - loss: 4.7753
Epoch 428/500
1/1 [==============================] - 0s 7ms/step - loss: 4.7786
Epoch 429/500
1/1 [==============================] - 0s 7ms/step - loss: 4.7261
Epoch 430/500
1/1 [==============================] - 0s 8ms/step - loss: 4.7564
Epoch 431/500
1/1 [==============================] - 0s 8ms/step - loss: 4.6920
Epoch 432/500
1/1 [==============================] - 0s 7ms/step - loss: 4.7168
Epoch 433/500
1/1 [==============================] - 0s 7ms/step - loss: 4.6429
Epoch 434/500
1/1 [==============================] - 0s 7ms/step - loss: 4.6709
Epoch 435/500
1/1 [==============================] - 0s 7ms/step - loss: 4.6009
Epoch 436/500
1/1 [==============================] - 0s 8ms/step - loss: 4.6255
Epoch 437/500
1/1 [==============================] - 0s 7ms/step - loss: 4.5382
Epoch 438/500
1/1 [==============================] - 0s 8ms/step - loss: 4.5309
Epoch 439/500
1/1 [==============================] - 0s 7ms/step - loss: 4.4859
Epoch 440/500
1/1 [==============================] - 0s 7ms/step - loss: 4.4624
Epoch 441/500
1/1 [==============================] - 0s 7ms/step - loss: 4.4400
Epoch 442/500
1/1 [==============================] - 0s 7ms/step - loss: 4.4286
Epoch 443/500
1/1 [==============================] - 0s 8ms/step - loss: 4.4094
Epoch 444/500
1/1 [==============================] - 0s 8ms/step - loss: 4.4052
Epoch 445/500
1/1 [==============================] - 0s 7ms/step - loss: 4.3738
Epoch 446/500
1/1 [==============================] - 0s 7ms/step - loss: 4.3711
Epoch 447/500
1/1 [==============================] - 0s 7ms/step - loss: 4.3369
Epoch 448/500
1/1 [==============================] - 0s 7ms/step - loss: 4.3301
Epoch 449/500
1/1 [==============================] - 0s 7ms/step - loss: 4.3063
Epoch 450/500
1/1 [==============================] - 0s 7ms/step - loss: 4.3286
Epoch 451/500
1/1 [==============================] - 0s 7ms/step - loss: 4.2712
Epoch 452/500
1/1 [==============================] - 0s 8ms/step - loss: 4.2927
Epoch 453/500
1/1 [==============================] - 0s 7ms/step - loss: 4.2355
Epoch 454/500
1/1 [==============================] - 0s 7ms/step - loss: 4.2511
Epoch 455/500
1/1 [==============================] - 0s 7ms/step - loss: 4.2059
Epoch 456/500
1/1 [==============================] - 0s 7ms/step - loss: 4.2424
Epoch 457/500
1/1 [==============================] - 0s 7ms/step - loss: 4.1806
Epoch 458/500
1/1 [==============================] - 0s 7ms/step - loss: 4.2069
Epoch 459/500
1/1 [==============================] - 0s 7ms/step - loss: 4.1363
Epoch 460/500
1/1 [==============================] - 0s 7ms/step - loss: 4.1588
Epoch 461/500
1/1 [==============================] - 0s 7ms/step - loss: 4.1055
Epoch 462/500
1/1 [==============================] - 0s 7ms/step - loss: 4.1389
Epoch 463/500
1/1 [==============================] - 0s 7ms/step - loss: 4.0822
Epoch 464/500
1/1 [==============================] - 0s 7ms/step - loss: 4.1277
Epoch 465/500
1/1 [==============================] - 0s 7ms/step - loss: 4.0529
Epoch 466/500
1/1 [==============================] - 0s 7ms/step - loss: 4.0908
Epoch 467/500
1/1 [==============================] - 0s 7ms/step - loss: 4.0162
Epoch 468/500
1/1 [==============================] - 0s 8ms/step - loss: 4.0546
Epoch 469/500
1/1 [==============================] - 0s 7ms/step - loss: 3.9738
Epoch 470/500
1/1 [==============================] - 0s 8ms/step - loss: 3.9816
Epoch 471/500
1/1 [==============================] - 0s 7ms/step - loss: 3.9415
Epoch 472/500
1/1 [==============================] - 0s 7ms/step - loss: 3.9470
Epoch 473/500
1/1 [==============================] - 0s 8ms/step - loss: 3.9068
Epoch 474/500
1/1 [==============================] - 0s 7ms/step - loss: 3.9080
Epoch 475/500
1/1 [==============================] - 0s 7ms/step - loss: 3.8703
Epoch 476/500
1/1 [==============================] - 0s 7ms/step - loss: 3.8540
Epoch 477/500
1/1 [==============================] - 0s 7ms/step - loss: 3.8390
Epoch 478/500
1/1 [==============================] - 0s 7ms/step - loss: 3.8187
Epoch 479/500
1/1 [==============================] - 0s 8ms/step - loss: 3.8078
Epoch 480/500
1/1 [==============================] - 0s 7ms/step - loss: 3.7864
Epoch 481/500
1/1 [==============================] - 0s 7ms/step - loss: 3.7688
Epoch 482/500
1/1 [==============================] - 0s 7ms/step - loss: 3.7503
Epoch 483/500
1/1 [==============================] - 0s 7ms/step - loss: 3.7298
Epoch 484/500
1/1 [==============================] - 0s 7ms/step - loss: 3.7141
Epoch 485/500
1/1 [==============================] - 0s 7ms/step - loss: 3.7024
Epoch 486/500
1/1 [==============================] - 0s 7ms/step - loss: 3.6856
Epoch 487/500
1/1 [==============================] - 0s 6ms/step - loss: 3.6714
Epoch 488/500
1/1 [==============================] - 0s 6ms/step - loss: 3.6540
Epoch 489/500
1/1 [==============================] - 0s 7ms/step - loss: 3.6399
Epoch 490/500
1/1 [==============================] - 0s 7ms/step - loss: 3.6235
Epoch 491/500
1/1 [==============================] - 0s 7ms/step - loss: 3.6093
Epoch 492/500
1/1 [==============================] - 0s 7ms/step - loss: 3.5924
Epoch 493/500
1/1 [==============================] - 0s 7ms/step - loss: 3.5776
Epoch 494/500
1/1 [==============================] - 0s 7ms/step - loss: 3.5623
Epoch 495/500
1/1 [==============================] - 0s 7ms/step - loss: 3.5476
Epoch 496/500
1/1 [==============================] - 0s 7ms/step - loss: 3.5330
Epoch 497/500
1/1 [==============================] - 0s 7ms/step - loss: 3.5184
Epoch 498/500
1/1 [==============================] - 0s 8ms/step - loss: 3.5038
Epoch 499/500
1/1 [==============================] - 0s 7ms/step - loss: 3.4893
Epoch 500/500
1/1 [==============================] - 0s 7ms/step - loss: 3.4747
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f1a0010dca0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">))</span> <span class="c1"># 거의 100퍼..</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9895</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">yy</span><span class="o">==</span> <span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span><span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">))</span> <span class="c1"># test err도 나쁘지 않아</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9855</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="풀이1:-은닉층을-포함한-신경망">
<a class="anchor" href="#%ED%92%80%EC%9D%B41:-%EC%9D%80%EB%8B%89%EC%B8%B5%EC%9D%84-%ED%8F%AC%ED%95%A8%ED%95%9C-%EC%8B%A0%EA%B2%BD%EB%A7%9D" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>풀이1: 은닉층을 포함한 신경망</strong><a class="anchor-link" href="#%ED%92%80%EC%9D%B41:-%EC%9D%80%EB%8B%89%EC%B8%B5%EC%9D%84-%ED%8F%AC%ED%95%A8%ED%95%9C-%EC%8B%A0%EA%B2%BD%EB%A7%9D"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gv</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">splines=line</span>
<span class="s1">subgraph cluster_1{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>
<span class="s1">    "x1"</span>
<span class="s1">    "x2"</span>
<span class="s1">    ".."</span>
<span class="s1">    "x784"</span>
<span class="s1">    label = "Layer 0"</span>
<span class="s1">}</span>
<span class="s1">subgraph cluster_2{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>
<span class="s1">    "x1" -&gt; "node1"</span>
<span class="s1">    "x2" -&gt; "node1"</span>
<span class="s1">    ".." -&gt; "node1"</span>
<span class="s1">    </span>
<span class="s1">    "x784" -&gt; "node1"</span>
<span class="s1">    "x1" -&gt; "node2"</span>
<span class="s1">    "x2" -&gt; "node2"</span>
<span class="s1">    ".." -&gt; "node2"</span>
<span class="s1">    "x784" -&gt; "node2"</span>
<span class="s1">    </span>
<span class="s1">    "x1" -&gt; "..."</span>
<span class="s1">    "x2" -&gt; "..."</span>
<span class="s1">    ".." -&gt; "..."</span>
<span class="s1">    "x784" -&gt; "..."</span>

<span class="s1">    "x1" -&gt; "node30"</span>
<span class="s1">    "x2" -&gt; "node30"</span>
<span class="s1">    ".." -&gt; "node30"</span>
<span class="s1">    "x784" -&gt; "node30"</span>


<span class="s1">    label = "Layer 1: relu"</span>
<span class="s1">}</span>
<span class="s1">subgraph cluster_3{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>
<span class="s1">    "node1" -&gt; "y"</span>
<span class="s1">    "node2" -&gt; "y"</span>
<span class="s1">    "..." -&gt; "y"</span>
<span class="s1">    "node30" -&gt; "y"</span>
<span class="s1">    label = "Layer 2: sigmoid"</span>
<span class="s1">}</span>
<span class="s1">'''</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Generated by graphviz version 3.0.0 (20220315.2325)
 -->
<!-- Title: G Pages: 1 -->
<svg width="383pt" height="261pt" viewbox="0.00 0.00 383.29 261.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 257)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-257 379.29,-257 379.29,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>cluster_1</title>
<polygon fill="lightgrey" stroke="lightgrey" points="8,-8 8,-245 91.59,-245 91.59,-8 8,-8"></polygon>
<text text-anchor="middle" x="49.8" y="-229.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_2</title>
<polygon fill="lightgrey" stroke="lightgrey" points="111.59,-8 111.59,-245 219.29,-245 219.29,-8 111.59,-8"></polygon>
<text text-anchor="middle" x="165.44" y="-229.8" font-family="Times,serif" font-size="14.00">Layer 1: relu</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_3</title>
<polygon fill="lightgrey" stroke="lightgrey" points="239.29,-89 239.29,-164 375.29,-164 375.29,-89 239.29,-89"></polygon>
<text text-anchor="middle" x="307.29" y="-148.8" font-family="Times,serif" font-size="14.00">Layer 2: sigmoid</text>
</g>
<!-- x1 -->
<g id="node1" class="node">
<title>x1</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-196" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-192.3" font-family="Times,serif" font-size="14.00">x1</text>
</g>
<!-- node1 -->
<g id="node5" class="node">
<title>node1</title>
<ellipse fill="none" stroke="black" cx="165.44" cy="-196" rx="38.99" ry="18"></ellipse>
<text text-anchor="middle" x="165.44" y="-192.3" font-family="Times,serif" font-size="14.00">node1</text>
</g>
<!-- x1&#45;&gt;node1 -->
<g id="edge1" class="edge">
<title>x1-&gt;node1</title>
<path fill="none" stroke="black" d="M76.87,-196C88.57,-196 102.75,-196 116.27,-196"></path>
<polygon fill="black" stroke="black" points="116.42,-199.5 126.42,-196 116.42,-192.5 116.42,-199.5"></polygon>
</g>
<!-- node2 -->
<g id="node6" class="node">
<title>node2</title>
<ellipse fill="none" stroke="black" cx="165.44" cy="-142" rx="38.99" ry="18"></ellipse>
<text text-anchor="middle" x="165.44" y="-138.3" font-family="Times,serif" font-size="14.00">node2</text>
</g>
<!-- x1&#45;&gt;node2 -->
<g id="edge5" class="edge">
<title>x1-&gt;node2</title>
<path fill="none" stroke="black" d="M72.17,-185.84C88.01,-178.32 109.97,-167.88 128.5,-159.08"></path>
<polygon fill="black" stroke="black" points="130.01,-162.23 137.54,-154.78 127.01,-155.91 130.01,-162.23"></polygon>
</g>
<!-- ... -->
<g id="node7" class="node">
<title>...</title>
<ellipse fill="none" stroke="black" cx="165.44" cy="-88" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="165.44" y="-84.3" font-family="Times,serif" font-size="14.00">...</text>
</g>
<!-- x1&#45;&gt;... -->
<g id="edge9" class="edge">
<title>x1-&gt;...</title>
<path fill="none" stroke="black" d="M66.12,-181.43C85.53,-163 119.12,-131.07 141.56,-109.74"></path>
<polygon fill="black" stroke="black" points="144.16,-112.11 148.99,-102.68 139.33,-107.03 144.16,-112.11"></polygon>
</g>
<!-- node30 -->
<g id="node8" class="node">
<title>node30</title>
<ellipse fill="none" stroke="black" cx="165.44" cy="-34" rx="44.69" ry="18"></ellipse>
<text text-anchor="middle" x="165.44" y="-30.3" font-family="Times,serif" font-size="14.00">node30</text>
</g>
<!-- x1&#45;&gt;node30 -->
<g id="edge13" class="edge">
<title>x1-&gt;node30</title>
<path fill="none" stroke="black" d="M62.11,-179.87C81.8,-151.81 122.52,-93.76 146.23,-59.97"></path>
<polygon fill="black" stroke="black" points="149.27,-61.72 152.15,-51.52 143.54,-57.7 149.27,-61.72"></polygon>
</g>
<!-- x2 -->
<g id="node2" class="node">
<title>x2</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-142" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-138.3" font-family="Times,serif" font-size="14.00">x2</text>
</g>
<!-- x2&#45;&gt;node1 -->
<g id="edge2" class="edge">
<title>x2-&gt;node1</title>
<path fill="none" stroke="black" d="M72.17,-152.16C88.01,-159.68 109.97,-170.12 128.5,-178.92"></path>
<polygon fill="black" stroke="black" points="127.01,-182.09 137.54,-183.22 130.01,-175.77 127.01,-182.09"></polygon>
</g>
<!-- x2&#45;&gt;node2 -->
<g id="edge6" class="edge">
<title>x2-&gt;node2</title>
<path fill="none" stroke="black" d="M76.87,-142C88.57,-142 102.75,-142 116.27,-142"></path>
<polygon fill="black" stroke="black" points="116.42,-145.5 126.42,-142 116.42,-138.5 116.42,-145.5"></polygon>
</g>
<!-- x2&#45;&gt;... -->
<g id="edge10" class="edge">
<title>x2-&gt;...</title>
<path fill="none" stroke="black" d="M72.17,-131.84C89.52,-123.6 114.21,-111.87 133.69,-102.61"></path>
<polygon fill="black" stroke="black" points="135.24,-105.75 142.77,-98.3 132.24,-99.43 135.24,-105.75"></polygon>
</g>
<!-- x2&#45;&gt;node30 -->
<g id="edge14" class="edge">
<title>x2-&gt;node30</title>
<path fill="none" stroke="black" d="M66.12,-127.43C84.98,-109.51 117.25,-78.84 139.66,-57.55"></path>
<polygon fill="black" stroke="black" points="142.29,-59.88 147.13,-50.45 137.47,-54.8 142.29,-59.88"></polygon>
</g>
<!-- .. -->
<g id="node3" class="node">
<title>..</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-88" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-84.3" font-family="Times,serif" font-size="14.00">..</text>
</g>
<!-- ..&#45;&gt;node1 -->
<g id="edge3" class="edge">
<title>..-&gt;node1</title>
<path fill="none" stroke="black" d="M66.12,-102.57C85.09,-120.59 117.63,-151.51 140.04,-172.81"></path>
<polygon fill="black" stroke="black" points="137.85,-175.56 147.51,-179.91 142.67,-170.48 137.85,-175.56"></polygon>
</g>
<!-- ..&#45;&gt;node2 -->
<g id="edge7" class="edge">
<title>..-&gt;node2</title>
<path fill="none" stroke="black" d="M72.17,-98.16C88.01,-105.68 109.97,-116.12 128.5,-124.92"></path>
<polygon fill="black" stroke="black" points="127.01,-128.09 137.54,-129.22 130.01,-121.77 127.01,-128.09"></polygon>
</g>
<!-- ..&#45;&gt;... -->
<g id="edge11" class="edge">
<title>..-&gt;...</title>
<path fill="none" stroke="black" d="M76.87,-88C91.92,-88 111.09,-88 127.66,-88"></path>
<polygon fill="black" stroke="black" points="128.1,-91.5 138.1,-88 128.1,-84.5 128.1,-91.5"></polygon>
</g>
<!-- ..&#45;&gt;node30 -->
<g id="edge15" class="edge">
<title>..-&gt;node30</title>
<path fill="none" stroke="black" d="M72.17,-77.84C87.5,-70.56 108.57,-60.55 126.7,-51.93"></path>
<polygon fill="black" stroke="black" points="128.33,-55.03 135.86,-47.58 125.33,-48.71 128.33,-55.03"></polygon>
</g>
<!-- x784 -->
<g id="node4" class="node">
<title>x784</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-34" rx="33.6" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-30.3" font-family="Times,serif" font-size="14.00">x784</text>
</g>
<!-- x784&#45;&gt;node1 -->
<g id="edge4" class="edge">
<title>x784-&gt;node1</title>
<path fill="none" stroke="black" d="M62.53,-50.73C82.42,-79.07 122.87,-136.74 146.38,-170.26"></path>
<polygon fill="black" stroke="black" points="143.65,-172.46 152.26,-178.63 149.38,-168.44 143.65,-172.46"></polygon>
</g>
<!-- x784&#45;&gt;node2 -->
<g id="edge8" class="edge">
<title>x784-&gt;node2</title>
<path fill="none" stroke="black" d="M67.08,-49.47C86.18,-67.63 118.05,-97.91 140.09,-118.86"></path>
<polygon fill="black" stroke="black" points="137.79,-121.5 147.45,-125.85 142.61,-116.42 137.79,-121.5"></polygon>
</g>
<!-- x784&#45;&gt;... -->
<g id="edge12" class="edge">
<title>x784-&gt;...</title>
<path fill="none" stroke="black" d="M75.46,-45.72C92.58,-53.85 115.51,-64.75 133.8,-73.44"></path>
<polygon fill="black" stroke="black" points="132.36,-76.63 142.89,-77.76 135.36,-70.31 132.36,-76.63"></polygon>
</g>
<!-- x784&#45;&gt;node30 -->
<g id="edge16" class="edge">
<title>x784-&gt;node30</title>
<path fill="none" stroke="black" d="M83.67,-34C91.95,-34 101.07,-34 110.11,-34"></path>
<polygon fill="black" stroke="black" points="110.23,-37.5 120.23,-34 110.23,-30.5 110.23,-37.5"></polygon>
</g>
<!-- y -->
<g id="node9" class="node">
<title>y</title>
<ellipse fill="none" stroke="black" cx="307.29" cy="-115" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="307.29" y="-111.3" font-family="Times,serif" font-size="14.00">y</text>
</g>
<!-- node1&#45;&gt;y -->
<g id="edge17" class="edge">
<title>node1-&gt;y</title>
<path fill="none" stroke="black" d="M190.48,-182.08C214.55,-168.14 251.59,-146.68 277.28,-131.8"></path>
<polygon fill="black" stroke="black" points="279.28,-134.69 286.18,-126.65 275.77,-128.63 279.28,-134.69"></polygon>
</g>
<!-- node2&#45;&gt;y -->
<g id="edge18" class="edge">
<title>node2-&gt;y</title>
<path fill="none" stroke="black" d="M201.73,-135.19C223.01,-131.08 250.01,-125.87 271.24,-121.77"></path>
<polygon fill="black" stroke="black" points="272,-125.18 281.15,-119.85 270.67,-118.31 272,-125.18"></polygon>
</g>
<!-- ...&#45;&gt;y -->
<g id="edge19" class="edge">
<title>...-&gt;y</title>
<path fill="none" stroke="black" d="M191.77,-92.89C213.94,-97.17 246.39,-103.44 271.09,-108.2"></path>
<polygon fill="black" stroke="black" points="270.67,-111.69 281.15,-110.15 271.99,-104.81 270.67,-111.69"></polygon>
</g>
<!-- node30&#45;&gt;y -->
<g id="edge20" class="edge">
<title>node30-&gt;y</title>
<path fill="none" stroke="black" d="M191.77,-48.67C215.88,-62.64 252.14,-83.64 277.38,-98.26"></path>
<polygon fill="black" stroke="black" points="275.73,-101.34 286.13,-103.33 279.23,-95.29 275.73,-101.34"></polygon>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43054</span><span class="p">)</span> <span class="c1"># 43054</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span> 
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'sgd'</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">binary_crossentropy</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">12000</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/100
1/1 [==============================] - 0s 140ms/step - loss: 32.5990
Epoch 2/100
1/1 [==============================] - 0s 9ms/step - loss: 6041.9629
Epoch 3/100
1/1 [==============================] - 0s 9ms/step - loss: 45273.3008
Epoch 4/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9923
Epoch 5/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8082
Epoch 6/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7354
Epoch 7/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6921
Epoch 8/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6903
Epoch 9/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6857
Epoch 10/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6701
Epoch 11/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6118
Epoch 12/100
1/1 [==============================] - 0s 9ms/step - loss: 0.5392
Epoch 13/100
1/1 [==============================] - 0s 9ms/step - loss: 0.5756
Epoch 14/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6272
Epoch 15/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6939
Epoch 16/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6937
Epoch 17/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6936
Epoch 18/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6935
Epoch 19/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6935
Epoch 20/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6934
Epoch 21/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6934
Epoch 22/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6933
Epoch 23/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6933
Epoch 24/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6933
Epoch 25/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6933
Epoch 26/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6933
Epoch 27/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6932
Epoch 28/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6932
Epoch 29/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6932
Epoch 30/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6932
Epoch 31/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6932
Epoch 32/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6932
Epoch 33/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6931
Epoch 34/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6931
Epoch 35/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6931
Epoch 36/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6930
Epoch 37/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6930
Epoch 38/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6929
Epoch 39/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6928
Epoch 40/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6927
Epoch 41/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6925
Epoch 42/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6921
Epoch 43/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6914
Epoch 44/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6899
Epoch 45/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6866
Epoch 46/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6770
Epoch 47/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6474
Epoch 48/100
1/1 [==============================] - 0s 8ms/step - loss: 0.5834
Epoch 49/100
1/1 [==============================] - 0s 9ms/step - loss: 0.5388
Epoch 50/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6171
Epoch 51/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6941
Epoch 52/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6939
Epoch 53/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6938
Epoch 54/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6937
Epoch 55/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6936
Epoch 56/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6935
Epoch 57/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6935
Epoch 58/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6934
Epoch 59/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6934
Epoch 60/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6934
Epoch 61/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6933
Epoch 62/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6933
Epoch 63/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6933
Epoch 64/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6932
Epoch 65/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6932
Epoch 66/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6932
Epoch 67/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6932
Epoch 68/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6932
Epoch 69/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6931
Epoch 70/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6931
Epoch 71/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6931
Epoch 72/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6931
Epoch 73/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6931
Epoch 74/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6931
Epoch 75/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6930
Epoch 76/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6930
Epoch 77/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6930
Epoch 78/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6930
Epoch 79/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6930
Epoch 80/100
1/1 [==============================] - 0s 10ms/step - loss: 0.6929
Epoch 81/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6929
Epoch 82/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6929
Epoch 83/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6928
Epoch 84/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6928
Epoch 85/100
1/1 [==============================] - 0s 7ms/step - loss: 0.6928
Epoch 86/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6927
Epoch 87/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6927
Epoch 88/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6926
Epoch 89/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6926
Epoch 90/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6925
Epoch 91/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6924
Epoch 92/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6922
Epoch 93/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6921
Epoch 94/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6918
Epoch 95/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6915
Epoch 96/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6909
Epoch 97/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6899
Epoch 98/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6881
Epoch 99/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6842
Epoch 100/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6755
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f19ec2139d0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">))</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">yy</span><span class="o">==</span> <span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span><span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">))</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.6119166666666667, 0.629)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">))</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">yy</span><span class="o">==</span> <span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span><span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">))</span>  <span class="c1">## 같은코드 </span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.6119166666666667, 0.629)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="풀이2:-옵티마이저-개선">
<a class="anchor" href="#%ED%92%80%EC%9D%B42:-%EC%98%B5%ED%8B%B0%EB%A7%88%EC%9D%B4%EC%A0%80-%EA%B0%9C%EC%84%A0" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>풀이2: 옵티마이저 개선</strong><a class="anchor-link" href="#%ED%92%80%EC%9D%B42:-%EC%98%B5%ED%8B%B0%EB%A7%88%EC%9D%B4%EC%A0%80-%EA%B0%9C%EC%84%A0"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43054</span><span class="p">)</span> <span class="c1"># 43054</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span> 
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">binary_crossentropy</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">12000</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/100
1/1 [==============================] - 0s 144ms/step - loss: 32.5990
Epoch 2/100
1/1 [==============================] - 0s 9ms/step - loss: 62.4840
Epoch 3/100
1/1 [==============================] - 0s 9ms/step - loss: 22.2778
Epoch 4/100
1/1 [==============================] - 0s 9ms/step - loss: 5.6634
Epoch 5/100
1/1 [==============================] - 0s 9ms/step - loss: 8.1100
Epoch 6/100
1/1 [==============================] - 0s 9ms/step - loss: 12.8669
Epoch 7/100
1/1 [==============================] - 0s 9ms/step - loss: 11.2434
Epoch 8/100
1/1 [==============================] - 0s 9ms/step - loss: 7.4865
Epoch 9/100
1/1 [==============================] - 0s 9ms/step - loss: 5.1794
Epoch 10/100
1/1 [==============================] - 0s 9ms/step - loss: 4.3302
Epoch 11/100
1/1 [==============================] - 0s 9ms/step - loss: 4.2609
Epoch 12/100
1/1 [==============================] - 0s 9ms/step - loss: 4.4693
Epoch 13/100
1/1 [==============================] - 0s 9ms/step - loss: 4.6003
Epoch 14/100
1/1 [==============================] - 0s 9ms/step - loss: 4.5109
Epoch 15/100
1/1 [==============================] - 0s 9ms/step - loss: 4.1785
Epoch 16/100
1/1 [==============================] - 0s 9ms/step - loss: 3.6427
Epoch 17/100
1/1 [==============================] - 0s 9ms/step - loss: 2.9936
Epoch 18/100
1/1 [==============================] - 0s 9ms/step - loss: 2.4167
Epoch 19/100
1/1 [==============================] - 0s 9ms/step - loss: 2.0280
Epoch 20/100
1/1 [==============================] - 0s 9ms/step - loss: 1.8472
Epoch 21/100
1/1 [==============================] - 0s 9ms/step - loss: 1.8564
Epoch 22/100
1/1 [==============================] - 0s 9ms/step - loss: 1.9634
Epoch 23/100
1/1 [==============================] - 0s 9ms/step - loss: 2.0864
Epoch 24/100
1/1 [==============================] - 0s 9ms/step - loss: 2.1449
Epoch 25/100
1/1 [==============================] - 0s 9ms/step - loss: 2.1044
Epoch 26/100
1/1 [==============================] - 0s 9ms/step - loss: 1.9749
Epoch 27/100
1/1 [==============================] - 0s 9ms/step - loss: 1.7834
Epoch 28/100
1/1 [==============================] - 0s 9ms/step - loss: 1.5853
Epoch 29/100
1/1 [==============================] - 0s 9ms/step - loss: 1.4317
Epoch 30/100
1/1 [==============================] - 0s 9ms/step - loss: 1.3280
Epoch 31/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2674
Epoch 32/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2435
Epoch 33/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2434
Epoch 34/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2541
Epoch 35/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2620
Epoch 36/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2632
Epoch 37/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2501
Epoch 38/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2226
Epoch 39/100
1/1 [==============================] - 0s 9ms/step - loss: 1.1842
Epoch 40/100
1/1 [==============================] - 0s 9ms/step - loss: 1.1403
Epoch 41/100
1/1 [==============================] - 0s 9ms/step - loss: 1.0960
Epoch 42/100
1/1 [==============================] - 0s 10ms/step - loss: 1.0573
Epoch 43/100
1/1 [==============================] - 0s 10ms/step - loss: 1.0240
Epoch 44/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9990
Epoch 45/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9817
Epoch 46/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9718
Epoch 47/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9673
Epoch 48/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9636
Epoch 49/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9574
Epoch 50/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9469
Epoch 51/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9322
Epoch 52/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9139
Epoch 53/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8945
Epoch 54/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8757
Epoch 55/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8587
Epoch 56/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8454
Epoch 57/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8348
Epoch 58/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8266
Epoch 59/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8207
Epoch 60/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8145
Epoch 61/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8074
Epoch 62/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7988
Epoch 63/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7898
Epoch 64/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7812
Epoch 65/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7728
Epoch 66/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7647
Epoch 67/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7574
Epoch 68/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7519
Epoch 69/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7473
Epoch 70/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7431
Epoch 71/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7389
Epoch 72/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7345
Epoch 73/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7290
Epoch 74/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7227
Epoch 75/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7162
Epoch 76/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7102
Epoch 77/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7045
Epoch 78/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6995
Epoch 79/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6957
Epoch 80/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6918
Epoch 81/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6880
Epoch 82/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6840
Epoch 83/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6798
Epoch 84/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6755
Epoch 85/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6713
Epoch 86/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6673
Epoch 87/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6635
Epoch 88/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6599
Epoch 89/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6567
Epoch 90/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6534
Epoch 91/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6500
Epoch 92/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6466
Epoch 93/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6431
Epoch 94/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6397
Epoch 95/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6363
Epoch 96/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6330
Epoch 97/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6298
Epoch 98/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6266
Epoch 99/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6235
Epoch 100/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6203
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f1a40eacbe0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">))</span> <span class="c1"># 거의 100퍼..</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9851666666666666</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">yy</span><span class="o">==</span> <span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span><span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">))</span> <span class="c1"># test err도 나쁘지 않아</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.979</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="풀이3:-컴파일시-metrics=['accuracy']-추가">
<a class="anchor" href="#%ED%92%80%EC%9D%B43:-%EC%BB%B4%ED%8C%8C%EC%9D%BC%EC%8B%9C-metrics=%5B'accuracy'%5D-%EC%B6%94%EA%B0%80" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>풀이3: 컴파일시 metrics=['accuracy'] 추가</strong><a class="anchor-link" href="#%ED%92%80%EC%9D%B43:-%EC%BB%B4%ED%8C%8C%EC%9D%BC%EC%8B%9C-metrics=%5B'accuracy'%5D-%EC%B6%94%EA%B0%80"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43054</span><span class="p">)</span> <span class="c1"># 43054</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span> 
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">binary_crossentropy</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>
<span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">12000</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/100
1/1 [==============================] - 0s 164ms/step - loss: 32.5990 - accuracy: 0.4780
Epoch 2/100
1/1 [==============================] - 0s 10ms/step - loss: 62.4840 - accuracy: 0.5049
Epoch 3/100
1/1 [==============================] - 0s 9ms/step - loss: 22.2778 - accuracy: 0.6697
Epoch 4/100
1/1 [==============================] - 0s 9ms/step - loss: 5.6634 - accuracy: 0.9117
Epoch 5/100
1/1 [==============================] - 0s 9ms/step - loss: 8.1100 - accuracy: 0.8633
Epoch 6/100
1/1 [==============================] - 0s 9ms/step - loss: 12.8669 - accuracy: 0.8176
Epoch 7/100
1/1 [==============================] - 0s 11ms/step - loss: 11.2434 - accuracy: 0.8454
Epoch 8/100
1/1 [==============================] - 0s 10ms/step - loss: 7.4865 - accuracy: 0.8931
Epoch 9/100
1/1 [==============================] - 0s 9ms/step - loss: 5.1794 - accuracy: 0.9256
Epoch 10/100
1/1 [==============================] - 0s 9ms/step - loss: 4.3302 - accuracy: 0.9439
Epoch 11/100
1/1 [==============================] - 0s 9ms/step - loss: 4.2609 - accuracy: 0.9508
Epoch 12/100
1/1 [==============================] - 0s 9ms/step - loss: 4.4693 - accuracy: 0.9536
Epoch 13/100
1/1 [==============================] - 0s 9ms/step - loss: 4.6003 - accuracy: 0.9533
Epoch 14/100
1/1 [==============================] - 0s 9ms/step - loss: 4.5109 - accuracy: 0.9548
Epoch 15/100
1/1 [==============================] - 0s 9ms/step - loss: 4.1785 - accuracy: 0.9557
Epoch 16/100
1/1 [==============================] - 0s 9ms/step - loss: 3.6427 - accuracy: 0.9582
Epoch 17/100
1/1 [==============================] - 0s 9ms/step - loss: 2.9936 - accuracy: 0.9605
Epoch 18/100
1/1 [==============================] - 0s 9ms/step - loss: 2.4167 - accuracy: 0.9632
Epoch 19/100
1/1 [==============================] - 0s 9ms/step - loss: 2.0280 - accuracy: 0.9663
Epoch 20/100
1/1 [==============================] - 0s 9ms/step - loss: 1.8472 - accuracy: 0.9675
Epoch 21/100
1/1 [==============================] - 0s 9ms/step - loss: 1.8564 - accuracy: 0.9674
Epoch 22/100
1/1 [==============================] - 0s 9ms/step - loss: 1.9634 - accuracy: 0.9670
Epoch 23/100
1/1 [==============================] - 0s 9ms/step - loss: 2.0864 - accuracy: 0.9656
Epoch 24/100
1/1 [==============================] - 0s 9ms/step - loss: 2.1449 - accuracy: 0.9653
Epoch 25/100
1/1 [==============================] - 0s 9ms/step - loss: 2.1044 - accuracy: 0.9655
Epoch 26/100
1/1 [==============================] - 0s 9ms/step - loss: 1.9749 - accuracy: 0.9664
Epoch 27/100
1/1 [==============================] - 0s 9ms/step - loss: 1.7834 - accuracy: 0.9681
Epoch 28/100
1/1 [==============================] - 0s 9ms/step - loss: 1.5853 - accuracy: 0.9713
Epoch 29/100
1/1 [==============================] - 0s 9ms/step - loss: 1.4317 - accuracy: 0.9747
Epoch 30/100
1/1 [==============================] - 0s 9ms/step - loss: 1.3280 - accuracy: 0.9762
Epoch 31/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2674 - accuracy: 0.9774
Epoch 32/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2435 - accuracy: 0.9781
Epoch 33/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2434 - accuracy: 0.9788
Epoch 34/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2541 - accuracy: 0.9787
Epoch 35/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2620 - accuracy: 0.9785
Epoch 36/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2632 - accuracy: 0.9784
Epoch 37/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2501 - accuracy: 0.9786
Epoch 38/100
1/1 [==============================] - 0s 9ms/step - loss: 1.2226 - accuracy: 0.9793
Epoch 39/100
1/1 [==============================] - 0s 9ms/step - loss: 1.1842 - accuracy: 0.9797
Epoch 40/100
1/1 [==============================] - 0s 9ms/step - loss: 1.1403 - accuracy: 0.9802
Epoch 41/100
1/1 [==============================] - 0s 9ms/step - loss: 1.0960 - accuracy: 0.9808
Epoch 42/100
1/1 [==============================] - 0s 9ms/step - loss: 1.0573 - accuracy: 0.9812
Epoch 43/100
1/1 [==============================] - 0s 9ms/step - loss: 1.0240 - accuracy: 0.9809
Epoch 44/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9990 - accuracy: 0.9808
Epoch 45/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9817 - accuracy: 0.9809
Epoch 46/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9718 - accuracy: 0.9811
Epoch 47/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9673 - accuracy: 0.9808
Epoch 48/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9636 - accuracy: 0.9805
Epoch 49/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9574 - accuracy: 0.9803
Epoch 50/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9469 - accuracy: 0.9805
Epoch 51/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9322 - accuracy: 0.9808
Epoch 52/100
1/1 [==============================] - 0s 9ms/step - loss: 0.9139 - accuracy: 0.9812
Epoch 53/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8945 - accuracy: 0.9813
Epoch 54/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8757 - accuracy: 0.9814
Epoch 55/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8587 - accuracy: 0.9818
Epoch 56/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8454 - accuracy: 0.9821
Epoch 57/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8348 - accuracy: 0.9822
Epoch 58/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8266 - accuracy: 0.9825
Epoch 59/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8207 - accuracy: 0.9827
Epoch 60/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8145 - accuracy: 0.9827
Epoch 61/100
1/1 [==============================] - 0s 9ms/step - loss: 0.8074 - accuracy: 0.9827
Epoch 62/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7988 - accuracy: 0.9829
Epoch 63/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7898 - accuracy: 0.9827
Epoch 64/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7812 - accuracy: 0.9827
Epoch 65/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7728 - accuracy: 0.9827
Epoch 66/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7647 - accuracy: 0.9827
Epoch 67/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7574 - accuracy: 0.9828
Epoch 68/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7519 - accuracy: 0.9831
Epoch 69/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7473 - accuracy: 0.9829
Epoch 70/100
1/1 [==============================] - 0s 8ms/step - loss: 0.7431 - accuracy: 0.9827
Epoch 71/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7389 - accuracy: 0.9829
Epoch 72/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7345 - accuracy: 0.9828
Epoch 73/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7290 - accuracy: 0.9833
Epoch 74/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7227 - accuracy: 0.9833
Epoch 75/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7162 - accuracy: 0.9833
Epoch 76/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7102 - accuracy: 0.9832
Epoch 77/100
1/1 [==============================] - 0s 9ms/step - loss: 0.7045 - accuracy: 0.9833
Epoch 78/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6995 - accuracy: 0.9837
Epoch 79/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6957 - accuracy: 0.9834
Epoch 80/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6918 - accuracy: 0.9834
Epoch 81/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6880 - accuracy: 0.9836
Epoch 82/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6840 - accuracy: 0.9840
Epoch 83/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6798 - accuracy: 0.9840
Epoch 84/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6755 - accuracy: 0.9841
Epoch 85/100
1/1 [==============================] - 0s 7ms/step - loss: 0.6713 - accuracy: 0.9844
Epoch 86/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6673 - accuracy: 0.9843
Epoch 87/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6635 - accuracy: 0.9844
Epoch 88/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6599 - accuracy: 0.9845
Epoch 89/100
1/1 [==============================] - 0s 7ms/step - loss: 0.6567 - accuracy: 0.9846
Epoch 90/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6534 - accuracy: 0.9847
Epoch 91/100
1/1 [==============================] - 0s 7ms/step - loss: 0.6500 - accuracy: 0.9845
Epoch 92/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6466 - accuracy: 0.9845
Epoch 93/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6431 - accuracy: 0.9847
Epoch 94/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6397 - accuracy: 0.9847
Epoch 95/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6363 - accuracy: 0.9846
Epoch 96/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6330 - accuracy: 0.9847
Epoch 97/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6298 - accuracy: 0.9848
Epoch 98/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6266 - accuracy: 0.9847
Epoch 99/100
1/1 [==============================] - 0s 9ms/step - loss: 0.6235 - accuracy: 0.9849
Epoch 100/100
1/1 [==============================] - 0s 8ms/step - loss: 0.6203 - accuracy: 0.9850
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f1a3fe53e20&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">))</span> <span class="c1"># 거의 100퍼..</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9851666666666666</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>375/375 [==============================] - 0s 347us/step - loss: 0.6171 - accuracy: 0.9852
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.6171361804008484, 0.9851666688919067]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">yy</span><span class="o">==</span> <span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span><span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">))</span> <span class="c1"># test err도 나쁘지 않아</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.979</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>63/63 [==============================] - 0s 538us/step - loss: 0.8388 - accuracy: 0.9790
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.8388426899909973, 0.9789999723434448]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="풀이4:-확률적경사하강법-이용">
<a class="anchor" href="#%ED%92%80%EC%9D%B44:-%ED%99%95%EB%A5%A0%EC%A0%81%EA%B2%BD%EC%82%AC%ED%95%98%EA%B0%95%EB%B2%95-%EC%9D%B4%EC%9A%A9" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이4: 확률적경사하강법 이용<a class="anchor-link" href="#%ED%92%80%EC%9D%B44:-%ED%99%95%EB%A5%A0%EC%A0%81%EA%B2%BD%EC%82%AC%ED%95%98%EA%B0%95%EB%B2%95-%EC%9D%B4%EC%9A%A9"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43054</span><span class="p">)</span> <span class="c1"># 43054</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span> 
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">binary_crossentropy</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>
<span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1200</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/10
10/10 [==============================] - 0s 1ms/step - loss: 16.8976 - accuracy: 0.7893
Epoch 2/10
10/10 [==============================] - 0s 1ms/step - loss: 3.8567 - accuracy: 0.9572
Epoch 3/10
10/10 [==============================] - 0s 1ms/step - loss: 1.8241 - accuracy: 0.9674
Epoch 4/10
10/10 [==============================] - 0s 1ms/step - loss: 1.2483 - accuracy: 0.9783
Epoch 5/10
10/10 [==============================] - 0s 1ms/step - loss: 1.0139 - accuracy: 0.9809
Epoch 6/10
10/10 [==============================] - 0s 1ms/step - loss: 0.8932 - accuracy: 0.9817
Epoch 7/10
10/10 [==============================] - 0s 1ms/step - loss: 0.8039 - accuracy: 0.9824
Epoch 8/10
10/10 [==============================] - 0s 1ms/step - loss: 0.7420 - accuracy: 0.9827
Epoch 9/10
10/10 [==============================] - 0s 1ms/step - loss: 0.6975 - accuracy: 0.9835
Epoch 10/10
10/10 [==============================] - 0s 1ms/step - loss: 0.6636 - accuracy: 0.9840
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f19ec2a2520&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">))</span> <span class="c1"># 거의 100퍼..</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9845833333333334</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>375/375 [==============================] - 0s 335us/step - loss: 0.6280 - accuracy: 0.9846
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.628049373626709, 0.98458331823349]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">yy</span><span class="o">==</span> <span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span><span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">))</span> <span class="c1"># test err도 나쁘지 않아</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9815</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>63/63 [==============================] - 0s 516us/step - loss: 0.8386 - accuracy: 0.9815
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.8386411666870117, 0.9815000295639038]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="yhat을-만드는-과정-복습">
<a class="anchor" href="#yhat%EC%9D%84-%EB%A7%8C%EB%93%9C%EB%8A%94-%EA%B3%BC%EC%A0%95-%EB%B3%B5%EC%8A%B5" aria-hidden="true"><span class="octicon octicon-link"></span></a>yhat을 만드는 과정 복습<a class="anchor-link" href="#yhat%EC%9D%84-%EB%A7%8C%EB%93%9C%EB%8A%94-%EA%B3%BC%EC%A0%95-%EB%B3%B5%EC%8A%B5"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="c1">## 2 </span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Activation</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Activation</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">))</span>
<span class="c1">## 3 </span>
<span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">binary_crossentropy</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span> 
<span class="c1">## 4 </span>
<span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">12000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f1a40492be0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l1</span><span class="p">,</span><span class="n">a1</span><span class="p">,</span><span class="n">l2</span><span class="p">,</span><span class="n">a2</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">layers</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l2</span><span class="p">(</span><span class="n">a1</span><span class="p">(</span><span class="n">l1</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(12000, 1), dtype=float32, numpy=
array([[-472.54636 ],
       [ -20.110598],
       [ -73.84007 ],
       ...,
       [ 172.61714 ],
       [  44.636295],
       [-131.24965 ]], dtype=float32)&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a2</span><span class="p">(</span><span class="n">l2</span><span class="p">(</span><span class="n">a1</span><span class="p">(</span><span class="n">l1</span><span class="p">(</span><span class="n">X</span><span class="p">))))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(12000, 1), dtype=float32, numpy=
array([[0.0000000e+00],
       [1.8453487e-09],
       [8.5440520e-33],
       ...,
       [1.0000000e+00],
       [1.0000000e+00],
       [0.0000000e+00]], dtype=float32)&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">213.75027</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1.4771929751182097e-93</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="예제2">
<a class="anchor" href="#%EC%98%88%EC%A0%9C2" aria-hidden="true"><span class="octicon octicon-link"></span></a>예제2<a class="anchor-link" href="#%EC%98%88%EC%A0%9C2"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="데이터정리">
<a class="anchor" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%A0%95%EB%A6%AC" aria-hidden="true"><span class="octicon octicon-link"></span></a>데이터정리<a class="anchor-link" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%A0%95%EB%A6%AC"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">XX</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">yy</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="풀이1:-아까-예제1-정도의-모델로!">
<a class="anchor" href="#%ED%92%80%EC%9D%B41:-%EC%95%84%EA%B9%8C-%EC%98%88%EC%A0%9C1-%EC%A0%95%EB%8F%84%EC%9D%98-%EB%AA%A8%EB%8D%B8%EB%A1%9C!" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이1: 아까 예제1 정도의 모델로!<a class="anchor-link" href="#%ED%92%80%EC%9D%B41:-%EC%95%84%EA%B9%8C-%EC%98%88%EC%A0%9C1-%EC%A0%95%EB%8F%84%EC%9D%98-%EB%AA%A8%EB%8D%B8%EB%A1%9C!"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gv</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">splines=line</span>
<span class="s1">subgraph cluster_1{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>
<span class="s1">    "x1"</span>
<span class="s1">    "x2"</span>
<span class="s1">    ".."</span>
<span class="s1">    "x784"</span>
<span class="s1">    label = "Layer 0"</span>
<span class="s1">}</span>
<span class="s1">subgraph cluster_2{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>
<span class="s1">    "x1" -&gt; "node1"</span>
<span class="s1">    "x2" -&gt; "node1"</span>
<span class="s1">    ".." -&gt; "node1"</span>
<span class="s1">    </span>
<span class="s1">    "x784" -&gt; "node1"</span>
<span class="s1">    "x1" -&gt; "node2"</span>
<span class="s1">    "x2" -&gt; "node2"</span>
<span class="s1">    ".." -&gt; "node2"</span>
<span class="s1">    "x784" -&gt; "node2"</span>
<span class="s1">    </span>
<span class="s1">    "x1" -&gt; "..."</span>
<span class="s1">    "x2" -&gt; "..."</span>
<span class="s1">    ".." -&gt; "..."</span>
<span class="s1">    "x784" -&gt; "..."</span>

<span class="s1">    "x1" -&gt; "node30"</span>
<span class="s1">    "x2" -&gt; "node30"</span>
<span class="s1">    ".." -&gt; "node30"</span>
<span class="s1">    "x784" -&gt; "node30"</span>


<span class="s1">    label = "Layer 1: relu"</span>
<span class="s1">}</span>
<span class="s1">subgraph cluster_3{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>

<span class="s1">    "node1" -&gt; "y10"</span>
<span class="s1">    "node2" -&gt; "y10"</span>
<span class="s1">    "..." -&gt; "y10"</span>
<span class="s1">    "node30" -&gt; "y10"</span>
<span class="s1">    </span>
<span class="s1">    "node1" -&gt; "y1"</span>
<span class="s1">    "node2" -&gt; "y1"</span>
<span class="s1">    "..." -&gt; "y1"</span>
<span class="s1">    "node30" -&gt; "y1"</span>
<span class="s1">    </span>
<span class="s1">    "node1" -&gt; "."</span>
<span class="s1">    "node2" -&gt; "."</span>
<span class="s1">    "..." -&gt; "."</span>
<span class="s1">    "node30" -&gt; "."</span>
<span class="s1">    </span>
<span class="s1">    label = "Layer 2: sigmoid"</span>
<span class="s1">}</span>
<span class="s1">'''</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Generated by graphviz version 3.0.0 (20220315.2325)
 -->
<!-- Title: G Pages: 1 -->
<svg width="383pt" height="261pt" viewbox="0.00 0.00 383.18 261.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 257)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-257 379.18,-257 379.18,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>cluster_1</title>
<polygon fill="lightgrey" stroke="lightgrey" points="8,-8 8,-245 91.59,-245 91.59,-8 8,-8"></polygon>
<text text-anchor="middle" x="49.8" y="-229.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_2</title>
<polygon fill="lightgrey" stroke="lightgrey" points="111.59,-8 111.59,-245 219.29,-245 219.29,-8 111.59,-8"></polygon>
<text text-anchor="middle" x="165.44" y="-229.8" font-family="Times,serif" font-size="14.00">Layer 1: relu</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_3</title>
<polygon fill="lightgrey" stroke="lightgrey" points="239.29,-35 239.29,-218 375.18,-218 375.18,-35 239.29,-35"></polygon>
<text text-anchor="middle" x="307.23" y="-202.8" font-family="Times,serif" font-size="14.00">Layer 2: sigmoid</text>
</g>
<!-- x1 -->
<g id="node1" class="node">
<title>x1</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-196" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-192.3" font-family="Times,serif" font-size="14.00">x1</text>
</g>
<!-- node1 -->
<g id="node5" class="node">
<title>node1</title>
<ellipse fill="none" stroke="black" cx="165.44" cy="-196" rx="38.99" ry="18"></ellipse>
<text text-anchor="middle" x="165.44" y="-192.3" font-family="Times,serif" font-size="14.00">node1</text>
</g>
<!-- x1&#45;&gt;node1 -->
<g id="edge1" class="edge">
<title>x1-&gt;node1</title>
<path fill="none" stroke="black" d="M76.87,-196C88.57,-196 102.75,-196 116.27,-196"></path>
<polygon fill="black" stroke="black" points="116.42,-199.5 126.42,-196 116.42,-192.5 116.42,-199.5"></polygon>
</g>
<!-- node2 -->
<g id="node6" class="node">
<title>node2</title>
<ellipse fill="none" stroke="black" cx="165.44" cy="-142" rx="38.99" ry="18"></ellipse>
<text text-anchor="middle" x="165.44" y="-138.3" font-family="Times,serif" font-size="14.00">node2</text>
</g>
<!-- x1&#45;&gt;node2 -->
<g id="edge5" class="edge">
<title>x1-&gt;node2</title>
<path fill="none" stroke="black" d="M72.17,-185.84C88.01,-178.32 109.97,-167.88 128.5,-159.08"></path>
<polygon fill="black" stroke="black" points="130.01,-162.23 137.54,-154.78 127.01,-155.91 130.01,-162.23"></polygon>
</g>
<!-- ... -->
<g id="node7" class="node">
<title>...</title>
<ellipse fill="none" stroke="black" cx="165.44" cy="-88" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="165.44" y="-84.3" font-family="Times,serif" font-size="14.00">...</text>
</g>
<!-- x1&#45;&gt;... -->
<g id="edge9" class="edge">
<title>x1-&gt;...</title>
<path fill="none" stroke="black" d="M66.12,-181.43C85.53,-163 119.12,-131.07 141.56,-109.74"></path>
<polygon fill="black" stroke="black" points="144.16,-112.11 148.99,-102.68 139.33,-107.03 144.16,-112.11"></polygon>
</g>
<!-- node30 -->
<g id="node8" class="node">
<title>node30</title>
<ellipse fill="none" stroke="black" cx="165.44" cy="-34" rx="44.69" ry="18"></ellipse>
<text text-anchor="middle" x="165.44" y="-30.3" font-family="Times,serif" font-size="14.00">node30</text>
</g>
<!-- x1&#45;&gt;node30 -->
<g id="edge13" class="edge">
<title>x1-&gt;node30</title>
<path fill="none" stroke="black" d="M62.11,-179.87C81.8,-151.81 122.52,-93.76 146.23,-59.97"></path>
<polygon fill="black" stroke="black" points="149.27,-61.72 152.15,-51.52 143.54,-57.7 149.27,-61.72"></polygon>
</g>
<!-- x2 -->
<g id="node2" class="node">
<title>x2</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-142" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-138.3" font-family="Times,serif" font-size="14.00">x2</text>
</g>
<!-- x2&#45;&gt;node1 -->
<g id="edge2" class="edge">
<title>x2-&gt;node1</title>
<path fill="none" stroke="black" d="M72.17,-152.16C88.01,-159.68 109.97,-170.12 128.5,-178.92"></path>
<polygon fill="black" stroke="black" points="127.01,-182.09 137.54,-183.22 130.01,-175.77 127.01,-182.09"></polygon>
</g>
<!-- x2&#45;&gt;node2 -->
<g id="edge6" class="edge">
<title>x2-&gt;node2</title>
<path fill="none" stroke="black" d="M76.87,-142C88.57,-142 102.75,-142 116.27,-142"></path>
<polygon fill="black" stroke="black" points="116.42,-145.5 126.42,-142 116.42,-138.5 116.42,-145.5"></polygon>
</g>
<!-- x2&#45;&gt;... -->
<g id="edge10" class="edge">
<title>x2-&gt;...</title>
<path fill="none" stroke="black" d="M72.17,-131.84C89.52,-123.6 114.21,-111.87 133.69,-102.61"></path>
<polygon fill="black" stroke="black" points="135.24,-105.75 142.77,-98.3 132.24,-99.43 135.24,-105.75"></polygon>
</g>
<!-- x2&#45;&gt;node30 -->
<g id="edge14" class="edge">
<title>x2-&gt;node30</title>
<path fill="none" stroke="black" d="M66.12,-127.43C84.98,-109.51 117.25,-78.84 139.66,-57.55"></path>
<polygon fill="black" stroke="black" points="142.29,-59.88 147.13,-50.45 137.47,-54.8 142.29,-59.88"></polygon>
</g>
<!-- .. -->
<g id="node3" class="node">
<title>..</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-88" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-84.3" font-family="Times,serif" font-size="14.00">..</text>
</g>
<!-- ..&#45;&gt;node1 -->
<g id="edge3" class="edge">
<title>..-&gt;node1</title>
<path fill="none" stroke="black" d="M66.12,-102.57C85.09,-120.59 117.63,-151.51 140.04,-172.81"></path>
<polygon fill="black" stroke="black" points="137.85,-175.56 147.51,-179.91 142.67,-170.48 137.85,-175.56"></polygon>
</g>
<!-- ..&#45;&gt;node2 -->
<g id="edge7" class="edge">
<title>..-&gt;node2</title>
<path fill="none" stroke="black" d="M72.17,-98.16C88.01,-105.68 109.97,-116.12 128.5,-124.92"></path>
<polygon fill="black" stroke="black" points="127.01,-128.09 137.54,-129.22 130.01,-121.77 127.01,-128.09"></polygon>
</g>
<!-- ..&#45;&gt;... -->
<g id="edge11" class="edge">
<title>..-&gt;...</title>
<path fill="none" stroke="black" d="M76.87,-88C91.92,-88 111.09,-88 127.66,-88"></path>
<polygon fill="black" stroke="black" points="128.1,-91.5 138.1,-88 128.1,-84.5 128.1,-91.5"></polygon>
</g>
<!-- ..&#45;&gt;node30 -->
<g id="edge15" class="edge">
<title>..-&gt;node30</title>
<path fill="none" stroke="black" d="M72.17,-77.84C87.5,-70.56 108.57,-60.55 126.7,-51.93"></path>
<polygon fill="black" stroke="black" points="128.33,-55.03 135.86,-47.58 125.33,-48.71 128.33,-55.03"></polygon>
</g>
<!-- x784 -->
<g id="node4" class="node">
<title>x784</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-34" rx="33.6" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-30.3" font-family="Times,serif" font-size="14.00">x784</text>
</g>
<!-- x784&#45;&gt;node1 -->
<g id="edge4" class="edge">
<title>x784-&gt;node1</title>
<path fill="none" stroke="black" d="M62.53,-50.73C82.42,-79.07 122.87,-136.74 146.38,-170.26"></path>
<polygon fill="black" stroke="black" points="143.65,-172.46 152.26,-178.63 149.38,-168.44 143.65,-172.46"></polygon>
</g>
<!-- x784&#45;&gt;node2 -->
<g id="edge8" class="edge">
<title>x784-&gt;node2</title>
<path fill="none" stroke="black" d="M67.08,-49.47C86.18,-67.63 118.05,-97.91 140.09,-118.86"></path>
<polygon fill="black" stroke="black" points="137.79,-121.5 147.45,-125.85 142.61,-116.42 137.79,-121.5"></polygon>
</g>
<!-- x784&#45;&gt;... -->
<g id="edge12" class="edge">
<title>x784-&gt;...</title>
<path fill="none" stroke="black" d="M75.46,-45.72C92.58,-53.85 115.51,-64.75 133.8,-73.44"></path>
<polygon fill="black" stroke="black" points="132.36,-76.63 142.89,-77.76 135.36,-70.31 132.36,-76.63"></polygon>
</g>
<!-- x784&#45;&gt;node30 -->
<g id="edge16" class="edge">
<title>x784-&gt;node30</title>
<path fill="none" stroke="black" d="M83.67,-34C91.95,-34 101.07,-34 110.11,-34"></path>
<polygon fill="black" stroke="black" points="110.23,-37.5 120.23,-34 110.23,-30.5 110.23,-37.5"></polygon>
</g>
<!-- y10 -->
<g id="node9" class="node">
<title>y10</title>
<ellipse fill="none" stroke="black" cx="307.23" cy="-61" rx="27.9" ry="18"></ellipse>
<text text-anchor="middle" x="307.23" y="-57.3" font-family="Times,serif" font-size="14.00">y10</text>
</g>
<!-- node1&#45;&gt;y10 -->
<g id="edge17" class="edge">
<title>node1-&gt;y10</title>
<path fill="none" stroke="black" d="M183.3,-179.72C208.39,-155.49 255.6,-109.89 283.65,-82.81"></path>
<polygon fill="black" stroke="black" points="286.26,-85.16 291.02,-75.69 281.4,-80.12 286.26,-85.16"></polygon>
</g>
<!-- y1 -->
<g id="node10" class="node">
<title>y1</title>
<ellipse fill="none" stroke="black" cx="307.23" cy="-169" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="307.23" y="-165.3" font-family="Times,serif" font-size="14.00">y1</text>
</g>
<!-- node1&#45;&gt;y1 -->
<g id="edge21" class="edge">
<title>node1-&gt;y1</title>
<path fill="none" stroke="black" d="M201.72,-189.19C222.99,-185.08 249.98,-179.87 271.2,-175.77"></path>
<polygon fill="black" stroke="black" points="271.96,-179.19 281.11,-173.85 270.63,-172.31 271.96,-179.19"></polygon>
</g>
<!-- . -->
<g id="node11" class="node">
<title>.</title>
<ellipse fill="none" stroke="black" cx="307.23" cy="-115" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="307.23" y="-111.3" font-family="Times,serif" font-size="14.00">.</text>
</g>
<!-- node1&#45;&gt;. -->
<g id="edge25" class="edge">
<title>node1-&gt;.</title>
<path fill="none" stroke="black" d="M190.47,-182.08C214.53,-168.14 251.56,-146.68 277.24,-131.8"></path>
<polygon fill="black" stroke="black" points="279.24,-134.69 286.14,-126.65 275.73,-128.63 279.24,-134.69"></polygon>
</g>
<!-- node2&#45;&gt;y10 -->
<g id="edge18" class="edge">
<title>node2-&gt;y10</title>
<path fill="none" stroke="black" d="M190.47,-128.08C214.39,-114.22 251.13,-92.93 276.79,-78.06"></path>
<polygon fill="black" stroke="black" points="278.8,-80.94 285.7,-72.9 275.29,-74.89 278.8,-80.94"></polygon>
</g>
<!-- node2&#45;&gt;y1 -->
<g id="edge22" class="edge">
<title>node2-&gt;y1</title>
<path fill="none" stroke="black" d="M201.72,-148.81C222.99,-152.92 249.98,-158.13 271.2,-162.23"></path>
<polygon fill="black" stroke="black" points="270.63,-165.69 281.11,-164.15 271.96,-158.81 270.63,-165.69"></polygon>
</g>
<!-- node2&#45;&gt;. -->
<g id="edge26" class="edge">
<title>node2-&gt;.</title>
<path fill="none" stroke="black" d="M201.72,-135.19C222.99,-131.08 249.98,-125.87 271.2,-121.77"></path>
<polygon fill="black" stroke="black" points="271.96,-125.19 281.11,-119.85 270.63,-118.31 271.96,-125.19"></polygon>
</g>
<!-- ...&#45;&gt;y10 -->
<g id="edge19" class="edge">
<title>...-&gt;y10</title>
<path fill="none" stroke="black" d="M191.76,-83.11C213.65,-78.88 245.56,-72.72 270.13,-67.97"></path>
<polygon fill="black" stroke="black" points="271,-71.37 280.16,-66.04 269.68,-64.5 271,-71.37"></polygon>
</g>
<!-- ...&#45;&gt;y1 -->
<g id="edge23" class="edge">
<title>...-&gt;y1</title>
<path fill="none" stroke="black" d="M186.47,-99.61C210.34,-113.44 250.42,-136.66 277.57,-152.39"></path>
<polygon fill="black" stroke="black" points="275.83,-155.43 286.24,-157.42 279.34,-149.37 275.83,-155.43"></polygon>
</g>
<!-- ...&#45;&gt;. -->
<g id="edge27" class="edge">
<title>...-&gt;.</title>
<path fill="none" stroke="black" d="M191.76,-92.89C213.92,-97.17 246.36,-103.44 271.05,-108.2"></path>
<polygon fill="black" stroke="black" points="270.62,-111.69 281.11,-110.15 271.95,-104.81 270.62,-111.69"></polygon>
</g>
<!-- node30&#45;&gt;y10 -->
<g id="edge20" class="edge">
<title>node30-&gt;y10</title>
<path fill="none" stroke="black" d="M206.13,-41.66C226.24,-45.55 250.49,-50.23 270.09,-54.02"></path>
<polygon fill="black" stroke="black" points="269.67,-57.5 280.15,-55.96 270.99,-50.63 269.67,-57.5"></polygon>
</g>
<!-- node30&#45;&gt;y1 -->
<g id="edge24" class="edge">
<title>node30-&gt;y1</title>
<path fill="none" stroke="black" d="M183.58,-50.55C208.77,-74.88 255.82,-120.32 283.75,-147.29"></path>
<polygon fill="black" stroke="black" points="281.47,-149.95 291.09,-154.38 286.33,-144.91 281.47,-149.95"></polygon>
</g>
<!-- node30&#45;&gt;. -->
<g id="edge28" class="edge">
<title>node30-&gt;.</title>
<path fill="none" stroke="black" d="M191.76,-48.67C215.86,-62.64 252.11,-83.64 277.34,-98.26"></path>
<polygon fill="black" stroke="black" points="275.68,-101.34 286.09,-103.33 279.19,-95.29 275.68,-101.34"></polygon>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">categorical_crossentropy</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span> 
<span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/100
100/100 [==============================] - 0s 920us/step - loss: 15.2989 - accuracy: 0.4801
Epoch 2/100
100/100 [==============================] - 0s 901us/step - loss: 1.8916 - accuracy: 0.4550
Epoch 3/100
100/100 [==============================] - 0s 905us/step - loss: 1.6494 - accuracy: 0.4969
Epoch 4/100
100/100 [==============================] - 0s 903us/step - loss: 1.5121 - accuracy: 0.5307
Epoch 5/100
100/100 [==============================] - 0s 900us/step - loss: 1.3805 - accuracy: 0.5591
Epoch 6/100
100/100 [==============================] - 0s 883us/step - loss: 1.2827 - accuracy: 0.5757
Epoch 7/100
100/100 [==============================] - 0s 876us/step - loss: 1.2101 - accuracy: 0.5873
Epoch 8/100
100/100 [==============================] - 0s 874us/step - loss: 1.1511 - accuracy: 0.5990
Epoch 9/100
100/100 [==============================] - 0s 915us/step - loss: 1.1012 - accuracy: 0.6097
Epoch 10/100
100/100 [==============================] - 0s 892us/step - loss: 1.0608 - accuracy: 0.6147
Epoch 11/100
100/100 [==============================] - 0s 896us/step - loss: 1.0254 - accuracy: 0.6238
Epoch 12/100
100/100 [==============================] - 0s 925us/step - loss: 0.9927 - accuracy: 0.6300
Epoch 13/100
100/100 [==============================] - 0s 885us/step - loss: 0.9587 - accuracy: 0.6387
Epoch 14/100
100/100 [==============================] - 0s 893us/step - loss: 0.9311 - accuracy: 0.6470
Epoch 15/100
100/100 [==============================] - 0s 908us/step - loss: 0.9002 - accuracy: 0.6560
Epoch 16/100
100/100 [==============================] - 0s 893us/step - loss: 0.8631 - accuracy: 0.6724
Epoch 17/100
100/100 [==============================] - 0s 887us/step - loss: 0.8427 - accuracy: 0.6761
Epoch 18/100
100/100 [==============================] - 0s 894us/step - loss: 0.8271 - accuracy: 0.6808
Epoch 19/100
100/100 [==============================] - 0s 929us/step - loss: 0.8055 - accuracy: 0.6851
Epoch 20/100
100/100 [==============================] - 0s 911us/step - loss: 0.7934 - accuracy: 0.6877
Epoch 21/100
100/100 [==============================] - 0s 894us/step - loss: 0.7822 - accuracy: 0.6899
Epoch 22/100
100/100 [==============================] - 0s 881us/step - loss: 0.7747 - accuracy: 0.6934
Epoch 23/100
100/100 [==============================] - 0s 894us/step - loss: 0.7570 - accuracy: 0.6953
Epoch 24/100
100/100 [==============================] - 0s 862us/step - loss: 0.7452 - accuracy: 0.6999
Epoch 25/100
100/100 [==============================] - 0s 915us/step - loss: 0.7359 - accuracy: 0.7034
Epoch 26/100
100/100 [==============================] - 0s 903us/step - loss: 0.7263 - accuracy: 0.7055
Epoch 27/100
100/100 [==============================] - 0s 933us/step - loss: 0.7118 - accuracy: 0.7098
Epoch 28/100
100/100 [==============================] - 0s 896us/step - loss: 0.7059 - accuracy: 0.7105
Epoch 29/100
100/100 [==============================] - 0s 906us/step - loss: 0.6920 - accuracy: 0.7154
Epoch 30/100
100/100 [==============================] - 0s 888us/step - loss: 0.6857 - accuracy: 0.7174
Epoch 31/100
100/100 [==============================] - 0s 854us/step - loss: 0.6799 - accuracy: 0.7180
Epoch 32/100
100/100 [==============================] - 0s 947us/step - loss: 0.6695 - accuracy: 0.7226
Epoch 33/100
100/100 [==============================] - 0s 932us/step - loss: 0.6626 - accuracy: 0.7219
Epoch 34/100
100/100 [==============================] - 0s 910us/step - loss: 0.6567 - accuracy: 0.7237
Epoch 35/100
100/100 [==============================] - 0s 864us/step - loss: 0.6512 - accuracy: 0.7266
Epoch 36/100
100/100 [==============================] - 0s 935us/step - loss: 0.6462 - accuracy: 0.7258
Epoch 37/100
100/100 [==============================] - 0s 862us/step - loss: 0.6417 - accuracy: 0.7276
Epoch 38/100
100/100 [==============================] - 0s 915us/step - loss: 0.6415 - accuracy: 0.7277
Epoch 39/100
100/100 [==============================] - 0s 867us/step - loss: 0.6316 - accuracy: 0.7297
Epoch 40/100
100/100 [==============================] - 0s 900us/step - loss: 0.6245 - accuracy: 0.7319
Epoch 41/100
100/100 [==============================] - 0s 868us/step - loss: 0.6183 - accuracy: 0.7331
Epoch 42/100
100/100 [==============================] - 0s 924us/step - loss: 0.6165 - accuracy: 0.7339
Epoch 43/100
100/100 [==============================] - 0s 884us/step - loss: 0.6165 - accuracy: 0.7378
Epoch 44/100
100/100 [==============================] - 0s 904us/step - loss: 0.6067 - accuracy: 0.7404
Epoch 45/100
100/100 [==============================] - 0s 879us/step - loss: 0.6024 - accuracy: 0.7432
Epoch 46/100
100/100 [==============================] - 0s 908us/step - loss: 0.5974 - accuracy: 0.7430
Epoch 47/100
100/100 [==============================] - 0s 893us/step - loss: 0.5901 - accuracy: 0.7432
Epoch 48/100
100/100 [==============================] - 0s 896us/step - loss: 0.5858 - accuracy: 0.7479
Epoch 49/100
100/100 [==============================] - 0s 926us/step - loss: 0.5859 - accuracy: 0.7469
Epoch 50/100
100/100 [==============================] - 0s 893us/step - loss: 0.5770 - accuracy: 0.7488
Epoch 51/100
100/100 [==============================] - 0s 957us/step - loss: 0.5734 - accuracy: 0.7502
Epoch 52/100
100/100 [==============================] - 0s 876us/step - loss: 0.5680 - accuracy: 0.7518
Epoch 53/100
100/100 [==============================] - 0s 901us/step - loss: 0.5602 - accuracy: 0.7567
Epoch 54/100
100/100 [==============================] - 0s 912us/step - loss: 0.5589 - accuracy: 0.7620
Epoch 55/100
100/100 [==============================] - 0s 939us/step - loss: 0.5548 - accuracy: 0.7655
Epoch 56/100
100/100 [==============================] - 0s 866us/step - loss: 0.5425 - accuracy: 0.7786
Epoch 57/100
100/100 [==============================] - 0s 914us/step - loss: 0.5357 - accuracy: 0.7853
Epoch 58/100
100/100 [==============================] - 0s 885us/step - loss: 0.5254 - accuracy: 0.7932
Epoch 59/100
100/100 [==============================] - 0s 895us/step - loss: 0.5175 - accuracy: 0.8012
Epoch 60/100
100/100 [==============================] - 0s 898us/step - loss: 0.5179 - accuracy: 0.8022
Epoch 61/100
100/100 [==============================] - 0s 902us/step - loss: 0.5111 - accuracy: 0.8045
Epoch 62/100
100/100 [==============================] - 0s 928us/step - loss: 0.5012 - accuracy: 0.8099
Epoch 63/100
100/100 [==============================] - 0s 858us/step - loss: 0.4972 - accuracy: 0.8131
Epoch 64/100
100/100 [==============================] - 0s 932us/step - loss: 0.4961 - accuracy: 0.8140
Epoch 65/100
100/100 [==============================] - 0s 904us/step - loss: 0.4840 - accuracy: 0.8178
Epoch 66/100
100/100 [==============================] - 0s 900us/step - loss: 0.4832 - accuracy: 0.8179
Epoch 67/100
100/100 [==============================] - 0s 907us/step - loss: 0.4814 - accuracy: 0.8189
Epoch 68/100
100/100 [==============================] - 0s 929us/step - loss: 0.4738 - accuracy: 0.8236
Epoch 69/100
100/100 [==============================] - 0s 886us/step - loss: 0.4718 - accuracy: 0.8243
Epoch 70/100
100/100 [==============================] - 0s 870us/step - loss: 0.4658 - accuracy: 0.8259
Epoch 71/100
100/100 [==============================] - 0s 923us/step - loss: 0.4648 - accuracy: 0.8260
Epoch 72/100
100/100 [==============================] - 0s 869us/step - loss: 0.4631 - accuracy: 0.8274
Epoch 73/100
100/100 [==============================] - 0s 932us/step - loss: 0.4616 - accuracy: 0.8277
Epoch 74/100
100/100 [==============================] - 0s 878us/step - loss: 0.4622 - accuracy: 0.8269
Epoch 75/100
100/100 [==============================] - 0s 908us/step - loss: 0.4547 - accuracy: 0.8297
Epoch 76/100
100/100 [==============================] - 0s 890us/step - loss: 0.4524 - accuracy: 0.8307
Epoch 77/100
100/100 [==============================] - 0s 909us/step - loss: 0.4544 - accuracy: 0.8278
Epoch 78/100
100/100 [==============================] - 0s 884us/step - loss: 0.4510 - accuracy: 0.8305
Epoch 79/100
100/100 [==============================] - 0s 947us/step - loss: 0.4486 - accuracy: 0.8330
Epoch 80/100
100/100 [==============================] - 0s 893us/step - loss: 0.4442 - accuracy: 0.8335
Epoch 81/100
100/100 [==============================] - 0s 889us/step - loss: 0.4453 - accuracy: 0.8320
Epoch 82/100
100/100 [==============================] - 0s 931us/step - loss: 0.4460 - accuracy: 0.8307
Epoch 83/100
100/100 [==============================] - 0s 914us/step - loss: 0.4485 - accuracy: 0.8303
Epoch 84/100
100/100 [==============================] - 0s 911us/step - loss: 0.4446 - accuracy: 0.8318
Epoch 85/100
100/100 [==============================] - 0s 892us/step - loss: 0.4365 - accuracy: 0.8347
Epoch 86/100
100/100 [==============================] - 0s 884us/step - loss: 0.4421 - accuracy: 0.8332
Epoch 87/100
100/100 [==============================] - 0s 913us/step - loss: 0.4384 - accuracy: 0.8353
Epoch 88/100
100/100 [==============================] - 0s 907us/step - loss: 0.4375 - accuracy: 0.8345
Epoch 89/100
100/100 [==============================] - 0s 915us/step - loss: 0.4402 - accuracy: 0.8332
Epoch 90/100
100/100 [==============================] - 0s 874us/step - loss: 0.4331 - accuracy: 0.8363
Epoch 91/100
100/100 [==============================] - 0s 913us/step - loss: 0.4337 - accuracy: 0.8359
Epoch 92/100
100/100 [==============================] - 0s 940us/step - loss: 0.4324 - accuracy: 0.8357
Epoch 93/100
100/100 [==============================] - 0s 905us/step - loss: 0.4301 - accuracy: 0.8383
Epoch 94/100
100/100 [==============================] - 0s 883us/step - loss: 0.4298 - accuracy: 0.8382
Epoch 95/100
100/100 [==============================] - 0s 919us/step - loss: 0.4273 - accuracy: 0.8389
Epoch 96/100
100/100 [==============================] - 0s 938us/step - loss: 0.4282 - accuracy: 0.8409
Epoch 97/100
100/100 [==============================] - 0s 883us/step - loss: 0.4245 - accuracy: 0.8449
Epoch 98/100
100/100 [==============================] - 0s 875us/step - loss: 0.4159 - accuracy: 0.8508
Epoch 99/100
100/100 [==============================] - 0s 915us/step - loss: 0.4098 - accuracy: 0.8543
Epoch 100/100
100/100 [==============================] - 0s 863us/step - loss: 0.4072 - accuracy: 0.8565
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f1a40ddcf70&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>313/313 [==============================] - 0s 338us/step - loss: 0.5581 - accuracy: 0.8199
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.5581112504005432, 0.8198999762535095]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="풀이2:-더-깊은-신경망">
<a class="anchor" href="#%ED%92%80%EC%9D%B42:-%EB%8D%94-%EA%B9%8A%EC%9D%80-%EC%8B%A0%EA%B2%BD%EB%A7%9D" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이2: 더 깊은 신경망<a class="anchor-link" href="#%ED%92%80%EC%9D%B42:-%EB%8D%94-%EA%B9%8A%EC%9D%80-%EC%8B%A0%EA%B2%BD%EB%A7%9D"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gv</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">splines=line</span>
<span class="s1">subgraph cluster_1{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>
<span class="s1">    "x1"</span>
<span class="s1">    "x2"</span>
<span class="s1">    ".."</span>
<span class="s1">    "x784"</span>
<span class="s1">    label = "Layer 0"</span>
<span class="s1">}</span>
<span class="s1">subgraph cluster_2{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>
<span class="s1">    "x1" -&gt; "node1"</span>
<span class="s1">    "x2" -&gt; "node1"</span>
<span class="s1">    ".." -&gt; "node1"</span>
<span class="s1">    </span>
<span class="s1">    "x784" -&gt; "node1"</span>
<span class="s1">    "x1" -&gt; "node2"</span>
<span class="s1">    "x2" -&gt; "node2"</span>
<span class="s1">    ".." -&gt; "node2"</span>
<span class="s1">    "x784" -&gt; "node2"</span>
<span class="s1">    </span>
<span class="s1">    "x1" -&gt; "..."</span>
<span class="s1">    "x2" -&gt; "..."</span>
<span class="s1">    ".." -&gt; "..."</span>
<span class="s1">    "x784" -&gt; "..."</span>

<span class="s1">    "x1" -&gt; "node500"</span>
<span class="s1">    "x2" -&gt; "node500"</span>
<span class="s1">    ".." -&gt; "node500"</span>
<span class="s1">    "x784" -&gt; "node500"</span>


<span class="s1">    label = "Layer 1: relu"</span>
<span class="s1">}</span>

<span class="s1">subgraph cluster_3{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>

<span class="s1">    "node1" -&gt; "node1(2)"</span>
<span class="s1">    "node2" -&gt; "node1(2)"</span>
<span class="s1">    "..." -&gt; "node1(2)"</span>
<span class="s1">    "node500" -&gt; "node1(2)"</span>

<span class="s1">    "node1" -&gt; "node2(2)"</span>
<span class="s1">    "node2" -&gt; "node2(2)"</span>
<span class="s1">    "..." -&gt; "node2(2)"</span>
<span class="s1">    "node500" -&gt; "node2(2)"</span>
<span class="s1">    </span>
<span class="s1">    "node1" -&gt; "...."</span>
<span class="s1">    "node2" -&gt; "...."</span>
<span class="s1">    "..." -&gt; "...."</span>
<span class="s1">    "node500" -&gt; "...."</span>
<span class="s1">    </span>
<span class="s1">    "node1" -&gt; "node500(2)"</span>
<span class="s1">    "node2" -&gt; "node500(2)"</span>
<span class="s1">    "..." -&gt; "node500(2)"</span>
<span class="s1">    "node500" -&gt; "node500(2)"</span>

<span class="s1">    </span>
<span class="s1">    label = "Layer 2: relu"</span>
<span class="s1">}</span>

<span class="s1">subgraph cluster_4{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>

<span class="s1">    "node1(2)" -&gt; "y10"</span>
<span class="s1">    "node2(2)" -&gt; "y10"</span>
<span class="s1">    "...." -&gt; "y10"</span>
<span class="s1">    "node500(2)" -&gt; "y10"</span>
<span class="s1">    </span>
<span class="s1">    "node1(2)" -&gt; "y1"</span>
<span class="s1">    "node2(2)" -&gt; "y1"</span>
<span class="s1">    "...." -&gt; "y1"</span>
<span class="s1">    "node500(2)" -&gt; "y1"</span>
<span class="s1">    </span>
<span class="s1">    "node1(2)" -&gt; "."</span>
<span class="s1">    "node2(2)" -&gt; "."</span>
<span class="s1">    "...." -&gt; "."</span>
<span class="s1">    "node500(2)" -&gt; "."</span>
<span class="s1">    </span>
<span class="s1">    label = "Layer 3: sigmoid"</span>
<span class="s1">}</span>
<span class="s1">'''</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Generated by graphviz version 3.0.0 (20220315.2325)
 -->
<!-- Title: G Pages: 1 -->
<svg width="556pt" height="261pt" viewbox="0.00 0.00 556.27 261.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 257)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-257 552.27,-257 552.27,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>cluster_1</title>
<polygon fill="lightgrey" stroke="lightgrey" points="8,-8 8,-245 91.59,-245 91.59,-8 8,-8"></polygon>
<text text-anchor="middle" x="49.8" y="-229.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_2</title>
<polygon fill="lightgrey" stroke="lightgrey" points="111.59,-8 111.59,-245 228.99,-245 228.99,-8 111.59,-8"></polygon>
<text text-anchor="middle" x="170.29" y="-229.8" font-family="Times,serif" font-size="14.00">Layer 1: relu</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_3</title>
<polygon fill="lightgrey" stroke="lightgrey" points="248.99,-8 248.99,-245 392.37,-245 392.37,-8 248.99,-8"></polygon>
<text text-anchor="middle" x="320.68" y="-229.8" font-family="Times,serif" font-size="14.00">Layer 2: relu</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_4</title>
<polygon fill="lightgrey" stroke="lightgrey" points="412.37,-35 412.37,-218 548.27,-218 548.27,-35 412.37,-35"></polygon>
<text text-anchor="middle" x="480.32" y="-202.8" font-family="Times,serif" font-size="14.00">Layer 3: sigmoid</text>
</g>
<!-- x1 -->
<g id="node1" class="node">
<title>x1</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-196" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-192.3" font-family="Times,serif" font-size="14.00">x1</text>
</g>
<!-- node1 -->
<g id="node5" class="node">
<title>node1</title>
<ellipse fill="none" stroke="black" cx="170.29" cy="-196" rx="38.99" ry="18"></ellipse>
<text text-anchor="middle" x="170.29" y="-192.3" font-family="Times,serif" font-size="14.00">node1</text>
</g>
<!-- x1&#45;&gt;node1 -->
<g id="edge1" class="edge">
<title>x1-&gt;node1</title>
<path fill="none" stroke="black" d="M76.8,-196C89.75,-196 105.84,-196 120.95,-196"></path>
<polygon fill="black" stroke="black" points="121.2,-199.5 131.2,-196 121.2,-192.5 121.2,-199.5"></polygon>
</g>
<!-- node2 -->
<g id="node6" class="node">
<title>node2</title>
<ellipse fill="none" stroke="black" cx="170.29" cy="-142" rx="38.99" ry="18"></ellipse>
<text text-anchor="middle" x="170.29" y="-138.3" font-family="Times,serif" font-size="14.00">node2</text>
</g>
<!-- x1&#45;&gt;node2 -->
<g id="edge5" class="edge">
<title>x1-&gt;node2</title>
<path fill="none" stroke="black" d="M72.53,-186.1C89.3,-178.46 112.87,-167.71 132.55,-158.74"></path>
<polygon fill="black" stroke="black" points="134.21,-161.84 141.85,-154.5 131.3,-155.47 134.21,-161.84"></polygon>
</g>
<!-- ... -->
<g id="node7" class="node">
<title>...</title>
<ellipse fill="none" stroke="black" cx="170.29" cy="-88" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="170.29" y="-84.3" font-family="Times,serif" font-size="14.00">...</text>
</g>
<!-- x1&#45;&gt;... -->
<g id="edge9" class="edge">
<title>x1-&gt;...</title>
<path fill="none" stroke="black" d="M66.78,-181.43C87.21,-162.81 122.74,-130.43 146.13,-109.11"></path>
<polygon fill="black" stroke="black" points="148.53,-111.66 153.56,-102.33 143.81,-106.48 148.53,-111.66"></polygon>
</g>
<!-- node500 -->
<g id="node8" class="node">
<title>node500</title>
<ellipse fill="none" stroke="black" cx="170.29" cy="-34" rx="50.89" ry="18"></ellipse>
<text text-anchor="middle" x="170.29" y="-30.3" font-family="Times,serif" font-size="14.00">node500</text>
</g>
<!-- x1&#45;&gt;node500 -->
<g id="edge13" class="edge">
<title>x1-&gt;node500</title>
<path fill="none" stroke="black" d="M62.59,-179.87C83.12,-151.81 125.58,-93.76 150.3,-59.97"></path>
<polygon fill="black" stroke="black" points="153.39,-61.66 156.47,-51.52 147.74,-57.53 153.39,-61.66"></polygon>
</g>
<!-- x2 -->
<g id="node2" class="node">
<title>x2</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-142" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-138.3" font-family="Times,serif" font-size="14.00">x2</text>
</g>
<!-- x2&#45;&gt;node1 -->
<g id="edge2" class="edge">
<title>x2-&gt;node1</title>
<path fill="none" stroke="black" d="M72.53,-151.9C89.3,-159.54 112.87,-170.29 132.55,-179.26"></path>
<polygon fill="black" stroke="black" points="131.3,-182.53 141.85,-183.5 134.21,-176.16 131.3,-182.53"></polygon>
</g>
<!-- x2&#45;&gt;node2 -->
<g id="edge6" class="edge">
<title>x2-&gt;node2</title>
<path fill="none" stroke="black" d="M76.8,-142C89.75,-142 105.84,-142 120.95,-142"></path>
<polygon fill="black" stroke="black" points="121.2,-145.5 131.2,-142 121.2,-138.5 121.2,-145.5"></polygon>
</g>
<!-- x2&#45;&gt;... -->
<g id="edge10" class="edge">
<title>x2-&gt;...</title>
<path fill="none" stroke="black" d="M72.53,-132.1C90.87,-123.74 117.36,-111.66 137.99,-102.26"></path>
<polygon fill="black" stroke="black" points="139.64,-105.36 147.29,-98.02 136.74,-98.99 139.64,-105.36"></polygon>
</g>
<!-- x2&#45;&gt;node500 -->
<g id="edge14" class="edge">
<title>x2-&gt;node500</title>
<path fill="none" stroke="black" d="M66.78,-127.43C86.41,-109.54 120,-78.93 143.35,-57.64"></path>
<polygon fill="black" stroke="black" points="145.81,-60.14 150.84,-50.81 141.09,-54.96 145.81,-60.14"></polygon>
</g>
<!-- .. -->
<g id="node3" class="node">
<title>..</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-88" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-84.3" font-family="Times,serif" font-size="14.00">..</text>
</g>
<!-- ..&#45;&gt;node1 -->
<g id="edge3" class="edge">
<title>..-&gt;node1</title>
<path fill="none" stroke="black" d="M66.78,-102.57C86.64,-120.67 120.77,-151.78 144.15,-173.09"></path>
<polygon fill="black" stroke="black" points="141.89,-175.76 151.64,-179.91 146.6,-170.59 141.89,-175.76"></polygon>
</g>
<!-- ..&#45;&gt;node2 -->
<g id="edge7" class="edge">
<title>..-&gt;node2</title>
<path fill="none" stroke="black" d="M72.53,-97.9C89.3,-105.54 112.87,-116.29 132.55,-125.26"></path>
<polygon fill="black" stroke="black" points="131.3,-128.53 141.85,-129.5 134.21,-122.16 131.3,-128.53"></polygon>
</g>
<!-- ..&#45;&gt;... -->
<g id="edge11" class="edge">
<title>..-&gt;...</title>
<path fill="none" stroke="black" d="M76.8,-88C93.2,-88 114.63,-88 132.73,-88"></path>
<polygon fill="black" stroke="black" points="132.94,-91.5 142.94,-88 132.94,-84.5 132.94,-91.5"></polygon>
</g>
<!-- ..&#45;&gt;node500 -->
<g id="edge15" class="edge">
<title>..-&gt;node500</title>
<path fill="none" stroke="black" d="M72.53,-78.1C88.31,-70.91 110.11,-60.97 129.02,-52.35"></path>
<polygon fill="black" stroke="black" points="130.67,-55.44 138.32,-48.11 127.77,-49.08 130.67,-55.44"></polygon>
</g>
<!-- x784 -->
<g id="node4" class="node">
<title>x784</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-34" rx="33.6" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-30.3" font-family="Times,serif" font-size="14.00">x784</text>
</g>
<!-- x784&#45;&gt;node1 -->
<g id="edge4" class="edge">
<title>x784-&gt;node1</title>
<path fill="none" stroke="black" d="M63.03,-50.73C83.77,-79.07 125.94,-136.74 150.46,-170.26"></path>
<polygon fill="black" stroke="black" points="147.86,-172.63 156.59,-178.63 153.51,-168.49 147.86,-172.63"></polygon>
</g>
<!-- x784&#45;&gt;node2 -->
<g id="edge8" class="edge">
<title>x784-&gt;node2</title>
<path fill="none" stroke="black" d="M67.77,-49.47C87.69,-67.63 120.92,-97.91 143.9,-118.86"></path>
<polygon fill="black" stroke="black" points="141.82,-121.7 151.57,-125.85 146.54,-116.53 141.82,-121.7"></polygon>
</g>
<!-- x784&#45;&gt;... -->
<g id="edge12" class="edge">
<title>x784-&gt;...</title>
<path fill="none" stroke="black" d="M75.93,-45.45C94.06,-53.72 118.66,-64.93 138.05,-73.77"></path>
<polygon fill="black" stroke="black" points="136.83,-77.05 147.38,-78.02 139.74,-70.69 136.83,-77.05"></polygon>
</g>
<!-- x784&#45;&gt;node500 -->
<g id="edge16" class="edge">
<title>x784-&gt;node500</title>
<path fill="none" stroke="black" d="M83.8,-34C91.68,-34 100.33,-34 109.01,-34"></path>
<polygon fill="black" stroke="black" points="109.17,-37.5 119.17,-34 109.17,-30.5 109.17,-37.5"></polygon>
</g>
<!-- node1(2) -->
<g id="node9" class="node">
<title>node1(2)</title>
<ellipse fill="none" stroke="black" cx="320.68" cy="-196" rx="51.99" ry="18"></ellipse>
<text text-anchor="middle" x="320.68" y="-192.3" font-family="Times,serif" font-size="14.00">node1(2)</text>
</g>
<!-- node1&#45;&gt;node1(2) -->
<g id="edge17" class="edge">
<title>node1-&gt;node1(2)</title>
<path fill="none" stroke="black" d="M209.5,-196C224.37,-196 241.77,-196 258.3,-196"></path>
<polygon fill="black" stroke="black" points="258.45,-199.5 268.45,-196 258.45,-192.5 258.45,-199.5"></polygon>
</g>
<!-- node2(2) -->
<g id="node10" class="node">
<title>node2(2)</title>
<ellipse fill="none" stroke="black" cx="320.68" cy="-142" rx="51.99" ry="18"></ellipse>
<text text-anchor="middle" x="320.68" y="-138.3" font-family="Times,serif" font-size="14.00">node2(2)</text>
</g>
<!-- node1&#45;&gt;node2(2) -->
<g id="edge21" class="edge">
<title>node1-&gt;node2(2)</title>
<path fill="none" stroke="black" d="M201.32,-185.07C222.38,-177.41 250.91,-167.02 274.69,-158.37"></path>
<polygon fill="black" stroke="black" points="276.01,-161.62 284.21,-154.91 273.62,-155.04 276.01,-161.62"></polygon>
</g>
<!-- .... -->
<g id="node11" class="node">
<title>....</title>
<ellipse fill="none" stroke="black" cx="320.68" cy="-88" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="320.68" y="-84.3" font-family="Times,serif" font-size="14.00">....</text>
</g>
<!-- node1&#45;&gt;.... -->
<g id="edge25" class="edge">
<title>node1-&gt;....</title>
<path fill="none" stroke="black" d="M191.92,-180.98C218.34,-161.76 264.14,-128.42 293.13,-107.32"></path>
<polygon fill="black" stroke="black" points="295.52,-109.91 301.55,-101.2 291.4,-104.25 295.52,-109.91"></polygon>
</g>
<!-- node500(2) -->
<g id="node12" class="node">
<title>node500(2)</title>
<ellipse fill="none" stroke="black" cx="320.68" cy="-34" rx="63.89" ry="18"></ellipse>
<text text-anchor="middle" x="320.68" y="-30.3" font-family="Times,serif" font-size="14.00">node500(2)</text>
</g>
<!-- node1&#45;&gt;node500(2) -->
<g id="edge29" class="edge">
<title>node1-&gt;node500(2)</title>
<path fill="none" stroke="black" d="M186.33,-179.58C212.39,-151.13 266.07,-92.53 296.78,-59"></path>
<polygon fill="black" stroke="black" points="299.53,-61.18 303.7,-51.45 294.36,-56.46 299.53,-61.18"></polygon>
</g>
<!-- node2&#45;&gt;node1(2) -->
<g id="edge18" class="edge">
<title>node2-&gt;node1(2)</title>
<path fill="none" stroke="black" d="M201.32,-152.93C222.38,-160.59 250.91,-170.98 274.69,-179.63"></path>
<polygon fill="black" stroke="black" points="273.62,-182.96 284.21,-183.09 276.01,-176.38 273.62,-182.96"></polygon>
</g>
<!-- node2&#45;&gt;node2(2) -->
<g id="edge22" class="edge">
<title>node2-&gt;node2(2)</title>
<path fill="none" stroke="black" d="M209.5,-142C224.37,-142 241.77,-142 258.3,-142"></path>
<polygon fill="black" stroke="black" points="258.45,-145.5 268.45,-142 258.45,-138.5 258.45,-145.5"></polygon>
</g>
<!-- node2&#45;&gt;.... -->
<g id="edge26" class="edge">
<title>node2-&gt;....</title>
<path fill="none" stroke="black" d="M201.32,-131.07C226.14,-122.04 261.33,-109.23 286.88,-99.93"></path>
<polygon fill="black" stroke="black" points="288.3,-103.14 296.5,-96.43 285.91,-96.56 288.3,-103.14"></polygon>
</g>
<!-- node2&#45;&gt;node500(2) -->
<g id="edge30" class="edge">
<title>node2-&gt;node500(2)</title>
<path fill="none" stroke="black" d="M191.92,-126.98C216.86,-108.84 259.07,-78.11 288.11,-56.98"></path>
<polygon fill="black" stroke="black" points="290.26,-59.74 296.29,-51.02 286.14,-54.08 290.26,-59.74"></polygon>
</g>
<!-- ...&#45;&gt;node1(2) -->
<g id="edge19" class="edge">
<title>...-&gt;node1(2)</title>
<path fill="none" stroke="black" d="M189.19,-101.03C213.88,-119 258.77,-151.67 288.9,-173.6"></path>
<polygon fill="black" stroke="black" points="287.22,-176.7 297.36,-179.76 291.34,-171.04 287.22,-176.7"></polygon>
</g>
<!-- ...&#45;&gt;node2(2) -->
<g id="edge23" class="edge">
<title>...-&gt;node2(2)</title>
<path fill="none" stroke="black" d="M194.48,-96.44C215.89,-104.23 248.3,-116.02 274.78,-125.66"></path>
<polygon fill="black" stroke="black" points="273.64,-128.97 284.23,-129.1 276.03,-122.39 273.64,-128.97"></polygon>
</g>
<!-- ...&#45;&gt;.... -->
<g id="edge27" class="edge">
<title>...-&gt;....</title>
<path fill="none" stroke="black" d="M197.48,-88C221.28,-88 256.62,-88 283.19,-88"></path>
<polygon fill="black" stroke="black" points="283.25,-91.5 293.25,-88 283.25,-84.5 283.25,-91.5"></polygon>
</g>
<!-- ...&#45;&gt;node500(2) -->
<g id="edge31" class="edge">
<title>...-&gt;node500(2)</title>
<path fill="none" stroke="black" d="M194.48,-79.56C214.93,-72.12 245.41,-61.03 271.18,-51.65"></path>
<polygon fill="black" stroke="black" points="272.59,-54.86 280.79,-48.15 270.19,-48.28 272.59,-54.86"></polygon>
</g>
<!-- node500&#45;&gt;node1(2) -->
<g id="edge20" class="edge">
<title>node500-&gt;node1(2)</title>
<path fill="none" stroke="black" d="M186.89,-51.03C213.2,-79.76 266.52,-137.97 296.98,-171.22"></path>
<polygon fill="black" stroke="black" points="294.51,-173.7 303.84,-178.71 299.67,-168.97 294.51,-173.7"></polygon>
</g>
<!-- node500&#45;&gt;node2(2) -->
<g id="edge24" class="edge">
<title>node500-&gt;node2(2)</title>
<path fill="none" stroke="black" d="M193.5,-50.17C218.86,-68.62 260.48,-98.91 288.94,-119.62"></path>
<polygon fill="black" stroke="black" points="287.17,-122.67 297.31,-125.72 291.29,-117.01 287.17,-122.67"></polygon>
</g>
<!-- node500&#45;&gt;.... -->
<g id="edge28" class="edge">
<title>node500-&gt;....</title>
<path fill="none" stroke="black" d="M206.46,-46.8C230.75,-55.64 262.86,-67.32 286.67,-75.99"></path>
<polygon fill="black" stroke="black" points="285.73,-79.37 296.33,-79.5 288.12,-72.79 285.73,-79.37"></polygon>
</g>
<!-- node500&#45;&gt;node500(2) -->
<g id="edge32" class="edge">
<title>node500-&gt;node500(2)</title>
<path fill="none" stroke="black" d="M221.11,-34C229.34,-34 238.02,-34 246.68,-34"></path>
<polygon fill="black" stroke="black" points="246.81,-37.5 256.81,-34 246.81,-30.5 246.81,-37.5"></polygon>
</g>
<!-- y10 -->
<g id="node13" class="node">
<title>y10</title>
<ellipse fill="none" stroke="black" cx="480.32" cy="-61" rx="27.9" ry="18"></ellipse>
<text text-anchor="middle" x="480.32" y="-57.3" font-family="Times,serif" font-size="14.00">y10</text>
</g>
<!-- node1(2)&#45;&gt;y10 -->
<g id="edge33" class="edge">
<title>node1(2)-&gt;y10</title>
<path fill="none" stroke="black" d="M341.33,-179.18C370.12,-154.52 423.73,-108.61 454.98,-81.84"></path>
<polygon fill="black" stroke="black" points="457.47,-84.32 462.79,-75.16 452.92,-79 457.47,-84.32"></polygon>
</g>
<!-- y1 -->
<g id="node14" class="node">
<title>y1</title>
<ellipse fill="none" stroke="black" cx="480.32" cy="-169" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="480.32" y="-165.3" font-family="Times,serif" font-size="14.00">y1</text>
</g>
<!-- node1(2)&#45;&gt;y1 -->
<g id="edge37" class="edge">
<title>node1(2)-&gt;y1</title>
<path fill="none" stroke="black" d="M367.7,-188.12C392.02,-183.95 421.41,-178.92 443.93,-175.06"></path>
<polygon fill="black" stroke="black" points="444.8,-178.46 454.06,-173.33 443.62,-171.56 444.8,-178.46"></polygon>
</g>
<!-- . -->
<g id="node15" class="node">
<title>.</title>
<ellipse fill="none" stroke="black" cx="480.32" cy="-115" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="480.32" y="-111.3" font-family="Times,serif" font-size="14.00">.</text>
</g>
<!-- node1(2)&#45;&gt;. -->
<g id="edge41" class="edge">
<title>node1(2)-&gt;.</title>
<path fill="none" stroke="black" d="M350.59,-181.14C378.54,-166.78 420.72,-145.11 449.1,-130.53"></path>
<polygon fill="black" stroke="black" points="450.86,-133.56 458.16,-125.87 447.66,-127.33 450.86,-133.56"></polygon>
</g>
<!-- node2(2)&#45;&gt;y10 -->
<g id="edge34" class="edge">
<title>node2(2)-&gt;y10</title>
<path fill="none" stroke="black" d="M350.59,-127.14C378.38,-112.86 420.24,-91.36 448.61,-76.78"></path>
<polygon fill="black" stroke="black" points="450.39,-79.8 457.68,-72.12 447.19,-73.58 450.39,-79.8"></polygon>
</g>
<!-- node2(2)&#45;&gt;y1 -->
<g id="edge38" class="edge">
<title>node2(2)-&gt;y1</title>
<path fill="none" stroke="black" d="M367.7,-149.88C392.02,-154.05 421.41,-159.08 443.93,-162.94"></path>
<polygon fill="black" stroke="black" points="443.62,-166.44 454.06,-164.67 444.8,-159.54 443.62,-166.44"></polygon>
</g>
<!-- node2(2)&#45;&gt;. -->
<g id="edge42" class="edge">
<title>node2(2)-&gt;.</title>
<path fill="none" stroke="black" d="M367.7,-134.12C392.02,-129.95 421.41,-124.92 443.93,-121.06"></path>
<polygon fill="black" stroke="black" points="444.8,-124.46 454.06,-119.33 443.62,-117.56 444.8,-124.46"></polygon>
</g>
<!-- ....&#45;&gt;y10 -->
<g id="edge35" class="edge">
<title>....-&gt;y10</title>
<path fill="none" stroke="black" d="M347.01,-83.66C373.01,-79.21 413.72,-72.24 443.12,-67.2"></path>
<polygon fill="black" stroke="black" points="443.74,-70.65 453,-65.51 442.56,-63.75 443.74,-70.65"></polygon>
</g>
<!-- ....&#45;&gt;y1 -->
<g id="edge39" class="edge">
<title>....-&gt;y1</title>
<path fill="none" stroke="black" d="M342.61,-98.76C369.94,-112.8 417.95,-137.46 449.19,-153.52"></path>
<polygon fill="black" stroke="black" points="447.81,-156.74 458.3,-158.2 451.01,-150.52 447.81,-156.74"></polygon>
</g>
<!-- ....&#45;&gt;. -->
<g id="edge43" class="edge">
<title>....-&gt;.</title>
<path fill="none" stroke="black" d="M347.01,-92.34C373.32,-96.85 414.7,-103.93 444.17,-108.98"></path>
<polygon fill="black" stroke="black" points="443.61,-112.43 454.06,-110.67 444.79,-105.53 443.61,-112.43"></polygon>
</g>
<!-- node500(2)&#45;&gt;y10 -->
<g id="edge36" class="edge">
<title>node500(2)-&gt;y10</title>
<path fill="none" stroke="black" d="M375.49,-43.22C397.82,-47.04 423.14,-51.38 443.18,-54.81"></path>
<polygon fill="black" stroke="black" points="442.69,-58.28 453.14,-56.52 443.88,-51.38 442.69,-58.28"></polygon>
</g>
<!-- node500(2)&#45;&gt;y1 -->
<g id="edge40" class="edge">
<title>node500(2)-&gt;y1</title>
<path fill="none" stroke="black" d="M341.64,-51.1C370.55,-75.85 423.97,-121.6 455.09,-148.25"></path>
<polygon fill="black" stroke="black" points="452.99,-151.06 462.86,-154.91 457.55,-145.74 452.99,-151.06"></polygon>
</g>
<!-- node500(2)&#45;&gt;. -->
<g id="edge44" class="edge">
<title>node500(2)-&gt;.</title>
<path fill="none" stroke="black" d="M352.45,-49.81C380.34,-64.14 421.22,-85.14 448.98,-99.41"></path>
<polygon fill="black" stroke="black" points="447.71,-102.69 458.21,-104.15 450.91,-96.47 447.71,-102.69"></polygon>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">categorical_crossentropy</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span> 
<span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/100
100/100 [==============================] - 0s 3ms/step - loss: 13.6950 - accuracy: 0.7260
Epoch 2/100
100/100 [==============================] - 0s 3ms/step - loss: 1.3744 - accuracy: 0.8098
Epoch 3/100
100/100 [==============================] - 0s 3ms/step - loss: 0.9224 - accuracy: 0.8270
Epoch 4/100
100/100 [==============================] - 0s 3ms/step - loss: 0.6802 - accuracy: 0.8423
Epoch 5/100
100/100 [==============================] - 0s 3ms/step - loss: 0.5299 - accuracy: 0.8571
Epoch 6/100
100/100 [==============================] - 0s 3ms/step - loss: 0.4481 - accuracy: 0.8685
Epoch 7/100
100/100 [==============================] - 0s 3ms/step - loss: 0.4075 - accuracy: 0.8745
Epoch 8/100
100/100 [==============================] - 0s 3ms/step - loss: 0.3755 - accuracy: 0.8791
Epoch 9/100
100/100 [==============================] - 0s 3ms/step - loss: 0.3268 - accuracy: 0.8908
Epoch 10/100
100/100 [==============================] - 0s 3ms/step - loss: 0.3067 - accuracy: 0.8956
Epoch 11/100
100/100 [==============================] - 0s 3ms/step - loss: 0.2803 - accuracy: 0.9024
Epoch 12/100
100/100 [==============================] - 0s 3ms/step - loss: 0.2599 - accuracy: 0.9079
Epoch 13/100
100/100 [==============================] - 0s 3ms/step - loss: 0.2448 - accuracy: 0.9115
Epoch 14/100
100/100 [==============================] - 0s 3ms/step - loss: 0.2439 - accuracy: 0.9124
Epoch 15/100
100/100 [==============================] - 0s 3ms/step - loss: 0.2341 - accuracy: 0.9161
Epoch 16/100
100/100 [==============================] - 0s 3ms/step - loss: 0.2264 - accuracy: 0.9190
Epoch 17/100
100/100 [==============================] - 0s 3ms/step - loss: 0.2115 - accuracy: 0.9231
Epoch 18/100
100/100 [==============================] - 0s 3ms/step - loss: 0.2038 - accuracy: 0.9249
Epoch 19/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1948 - accuracy: 0.9282
Epoch 20/100
100/100 [==============================] - 0s 3ms/step - loss: 0.2010 - accuracy: 0.9264
Epoch 21/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1957 - accuracy: 0.9287
Epoch 22/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1934 - accuracy: 0.9302
Epoch 23/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1992 - accuracy: 0.9280
Epoch 24/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1974 - accuracy: 0.9287
Epoch 25/100
100/100 [==============================] - 0s 3ms/step - loss: 0.2007 - accuracy: 0.9281
Epoch 26/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1903 - accuracy: 0.9318
Epoch 27/100
100/100 [==============================] - 0s 3ms/step - loss: 0.2050 - accuracy: 0.9269
Epoch 28/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1866 - accuracy: 0.9319
Epoch 29/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1963 - accuracy: 0.9302
Epoch 30/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1993 - accuracy: 0.9295
Epoch 31/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1879 - accuracy: 0.9323
Epoch 32/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1885 - accuracy: 0.9329
Epoch 33/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1769 - accuracy: 0.9368
Epoch 34/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1937 - accuracy: 0.9317
Epoch 35/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1935 - accuracy: 0.9308
Epoch 36/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1851 - accuracy: 0.9351
Epoch 37/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1996 - accuracy: 0.9301
Epoch 38/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1962 - accuracy: 0.9311
Epoch 39/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1766 - accuracy: 0.9353
Epoch 40/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1807 - accuracy: 0.9352
Epoch 41/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1769 - accuracy: 0.9372
Epoch 42/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1759 - accuracy: 0.9378
Epoch 43/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1899 - accuracy: 0.9327
Epoch 44/100
100/100 [==============================] - 0s 3ms/step - loss: 0.2166 - accuracy: 0.9262
Epoch 45/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1945 - accuracy: 0.9323
Epoch 46/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1862 - accuracy: 0.9346
Epoch 47/100
100/100 [==============================] - 0s 3ms/step - loss: 0.2128 - accuracy: 0.9261
Epoch 48/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1795 - accuracy: 0.9352
Epoch 49/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1895 - accuracy: 0.9333
Epoch 50/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1981 - accuracy: 0.9327
Epoch 51/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1834 - accuracy: 0.9347
Epoch 52/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1669 - accuracy: 0.9392
Epoch 53/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1728 - accuracy: 0.9388
Epoch 54/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1714 - accuracy: 0.9385
Epoch 55/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1921 - accuracy: 0.9319
Epoch 56/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1893 - accuracy: 0.9337
Epoch 57/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1850 - accuracy: 0.9352
Epoch 58/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1861 - accuracy: 0.9354
Epoch 59/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1849 - accuracy: 0.9349
Epoch 60/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1796 - accuracy: 0.9365
Epoch 61/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1638 - accuracy: 0.9423
Epoch 62/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1644 - accuracy: 0.9417
Epoch 63/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1750 - accuracy: 0.9367
Epoch 64/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1678 - accuracy: 0.9403
Epoch 65/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1722 - accuracy: 0.9383
Epoch 66/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1751 - accuracy: 0.9388
Epoch 67/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1697 - accuracy: 0.9387
Epoch 68/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1502 - accuracy: 0.9459
Epoch 69/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1534 - accuracy: 0.9438
Epoch 70/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1617 - accuracy: 0.9420
Epoch 71/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1387 - accuracy: 0.9495
Epoch 72/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1523 - accuracy: 0.9457
Epoch 73/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1489 - accuracy: 0.9463
Epoch 74/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1579 - accuracy: 0.9428
Epoch 75/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1289 - accuracy: 0.9527
Epoch 76/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1463 - accuracy: 0.9474
Epoch 77/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1400 - accuracy: 0.9490
Epoch 78/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1287 - accuracy: 0.9531
Epoch 79/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1316 - accuracy: 0.9515
Epoch 80/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1448 - accuracy: 0.9480
Epoch 81/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1441 - accuracy: 0.9490
Epoch 82/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1433 - accuracy: 0.9488
Epoch 83/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1310 - accuracy: 0.9517
Epoch 84/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1190 - accuracy: 0.9552
Epoch 85/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1277 - accuracy: 0.9533
Epoch 86/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1318 - accuracy: 0.9522
Epoch 87/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1286 - accuracy: 0.9531
Epoch 88/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1332 - accuracy: 0.9519
Epoch 89/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1161 - accuracy: 0.9577
Epoch 90/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1089 - accuracy: 0.9596
Epoch 91/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1138 - accuracy: 0.9578
Epoch 92/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1129 - accuracy: 0.9589
Epoch 93/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1221 - accuracy: 0.9565
Epoch 94/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1300 - accuracy: 0.9551
Epoch 95/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1239 - accuracy: 0.9552
Epoch 96/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1092 - accuracy: 0.9592
Epoch 97/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1201 - accuracy: 0.9566
Epoch 98/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1222 - accuracy: 0.9558
Epoch 99/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1111 - accuracy: 0.9596
Epoch 100/100
100/100 [==============================] - 0s 3ms/step - loss: 0.1143 - accuracy: 0.9584
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f19dc53bfd0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>313/313 [==============================] - 0s 522us/step - loss: 0.6244 - accuracy: 0.8824
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.6243994832038879, 0.8823999762535095]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "sequential_10"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_20 (Dense)            (None, 500)               392500    
                                                                 
 dense_21 (Dense)            (None, 500)               250500    
                                                                 
 dense_22 (Dense)            (None, 10)                5010      
                                                                 
=================================================================
Total params: 648,010
Trainable params: 648,010
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="데이터-다시-정리-(데이터-자체를-2D로-해석하자)">
<a class="anchor" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%8B%A4%EC%8B%9C-%EC%A0%95%EB%A6%AC-(%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%9E%90%EC%B2%B4%EB%A5%BC-2D%EB%A1%9C-%ED%95%B4%EC%84%9D%ED%95%98%EC%9E%90)" aria-hidden="true"><span class="octicon octicon-link"></span></a>데이터 다시 정리 (데이터 자체를 2D로 해석하자)<a class="anchor-link" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%8B%A4%EC%8B%9C-%EC%A0%95%EB%A6%AC-(%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%9E%90%EC%B2%B4%EB%A5%BC-2D%EB%A1%9C-%ED%95%B4%EC%84%9D%ED%95%98%EC%9E%90)"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 데이터를 다시 정리 // X를 펼치치 않음 + 이미지의 차원을 (28,28,1)로 통일.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">XX</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="풀이3:-CNN">
<a class="anchor" href="#%ED%92%80%EC%9D%B43:-CNN" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이3: CNN<a class="anchor-link" href="#%ED%92%80%EC%9D%B43:-CNN"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43052</span><span class="p">)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Convolution2D</span><span class="p">(</span><span class="mi">30</span><span class="p">,(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">())</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Convolution2D</span><span class="p">(</span><span class="mi">30</span><span class="p">,(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">())</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">categorical_crossentropy</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span> 
<span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/20
100/100 [==============================] - 5s 45ms/step - loss: 3.6700 - accuracy: 0.5986
Epoch 2/20
100/100 [==============================] - 5s 46ms/step - loss: 0.6959 - accuracy: 0.7712
Epoch 3/20
100/100 [==============================] - 5s 46ms/step - loss: 0.5487 - accuracy: 0.8138
Epoch 4/20
100/100 [==============================] - 5s 45ms/step - loss: 0.4758 - accuracy: 0.8371
Epoch 5/20
100/100 [==============================] - 5s 45ms/step - loss: 0.4271 - accuracy: 0.8519
Epoch 6/20
100/100 [==============================] - 5s 45ms/step - loss: 0.3953 - accuracy: 0.8618
Epoch 7/20
100/100 [==============================] - 5s 45ms/step - loss: 0.3670 - accuracy: 0.8702
Epoch 8/20
100/100 [==============================] - 5s 46ms/step - loss: 0.3466 - accuracy: 0.8773
Epoch 9/20
100/100 [==============================] - 5s 46ms/step - loss: 0.3346 - accuracy: 0.8811
Epoch 10/20
100/100 [==============================] - 5s 46ms/step - loss: 0.3166 - accuracy: 0.8872
Epoch 11/20
100/100 [==============================] - 5s 46ms/step - loss: 0.3032 - accuracy: 0.8923
Epoch 12/20
100/100 [==============================] - 5s 46ms/step - loss: 0.2935 - accuracy: 0.8947
Epoch 13/20
100/100 [==============================] - 5s 46ms/step - loss: 0.2820 - accuracy: 0.9002
Epoch 14/20
100/100 [==============================] - 5s 45ms/step - loss: 0.2734 - accuracy: 0.9020
Epoch 15/20
100/100 [==============================] - 5s 46ms/step - loss: 0.2682 - accuracy: 0.9041
Epoch 16/20
100/100 [==============================] - 5s 46ms/step - loss: 0.2584 - accuracy: 0.9065
Epoch 17/20
100/100 [==============================] - 5s 45ms/step - loss: 0.2516 - accuracy: 0.9095
Epoch 18/20
100/100 [==============================] - 5s 45ms/step - loss: 0.2461 - accuracy: 0.9100
Epoch 19/20
100/100 [==============================] - 5s 45ms/step - loss: 0.2391 - accuracy: 0.9139
Epoch 20/20
100/100 [==============================] - 5s 46ms/step - loss: 0.2319 - accuracy: 0.9165
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f1a40b5de50&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>313/313 [==============================] - 0s 964us/step - loss: 0.3827 - accuracy: 0.8772
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.3827328681945801, 0.8772000074386597]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "sequential_8"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d (Conv2D)             (None, 24, 24, 30)        780       
                                                                 
 max_pooling2d (MaxPooling2D  (None, 12, 12, 30)       0         
 )                                                               
                                                                 
 conv2d_1 (Conv2D)           (None, 8, 8, 30)          22530     
                                                                 
 max_pooling2d_1 (MaxPooling  (None, 4, 4, 30)         0         
 2D)                                                             
                                                                 
 flatten (Flatten)           (None, 480)               0         
                                                                 
 dense_16 (Dense)            (None, 10)                4810      
                                                                 
=================================================================
Total params: 28,120
Trainable params: 28,120
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="guebin/DS2022"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/DS2022/2022/05/02/(9%EC%A3%BC%EC%B0%A8)-5%EC%9B%942%EC%9D%BC_draft.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/DS2022/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/DS2022/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/DS2022/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" target="_blank" title="fastai"><svg class="svg-icon grey"><use xlink:href="/DS2022/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" target="_blank" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/DS2022/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
